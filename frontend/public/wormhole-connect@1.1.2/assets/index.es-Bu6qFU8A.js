const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B-0vsM22.js","main.js","main.css"])))=>i.map(i=>d[i]);
import{a6 as xo,P as Iw,i as te,s as Pw,_ as Sw}from"../main.js";import{e as bt,a as Ao}from"./events-DXt1Ggbt.js";import{c as q,s as Do,x as zh,r as Hh,H as Ow,a as Vh,q as Ss}from"./index-a3leo5hT.js";import{I as lr,f as ft,t as nt,c as $u,C as Rw,r as Nw,a as Dr,g as Kh,i as _t,b as $s,d as $w,E as ze,y as Qe,q as Cs,k as Ts,h as Cw,e as Cu,j as Tw,s as xw,l as Aw,m as qo,n as xs,o as jo,p as Bt,u as Dw,v as Tu,w as qw}from"./index-C-uA0wrU.js";import{o as xu}from"./browser-ponyfill-D00zta0o.js";var se={};Object.defineProperty(se,"__esModule",{value:!0});se.getLocalStorage=se.getLocalStorageOrThrow=se.getCrypto=se.getCryptoOrThrow=se.getLocation=se.getLocationOrThrow=se.getNavigator=se.getNavigatorOrThrow=se.getDocument=se.getDocumentOrThrow=se.getFromWindowOrThrow=se.getFromWindow=void 0;function pr(o){let t;return typeof window<"u"&&typeof window[o]<"u"&&(t=window[o]),t}se.getFromWindow=pr;function Ur(o){const t=pr(o);if(!t)throw new Error(`${o} is not defined in Window`);return t}se.getFromWindowOrThrow=Ur;function jw(){return Ur("document")}se.getDocumentOrThrow=jw;function Uw(){return pr("document")}se.getDocument=Uw;function Mw(){return Ur("navigator")}se.getNavigatorOrThrow=Mw;function Lw(){return pr("navigator")}se.getNavigator=Lw;function kw(){return Ur("location")}se.getLocationOrThrow=kw;function zw(){return pr("location")}se.getLocation=zw;function Hw(){return Ur("crypto")}se.getCryptoOrThrow=Hw;function Vw(){return pr("crypto")}se.getCrypto=Vw;function Kw(){return Ur("localStorage")}se.getLocalStorageOrThrow=Kw;function Fw(){return pr("localStorage")}se.getLocalStorage=Fw;var Uo={};Object.defineProperty(Uo,"__esModule",{value:!0});Uo.getWindowMetadata=void 0;const Au=se;function Ww(){let o,t;try{o=Au.getDocumentOrThrow(),t=Au.getLocationOrThrow()}catch{return null}function r(){const S=o.getElementsByTagName("link"),R=[];for(let j=0;j<S.length;j++){const x=S[j],K=x.getAttribute("rel");if(K&&K.toLowerCase().indexOf("icon")>-1){const A=x.getAttribute("href");if(A)if(A.toLowerCase().indexOf("https:")===-1&&A.toLowerCase().indexOf("http:")===-1&&A.indexOf("//")!==0){let B=t.protocol+"//"+t.host;if(A.indexOf("/")===0)B+=A;else{const pe=t.pathname.split("/");pe.pop();const J=pe.join("/");B+=J+"/"+A}R.push(B)}else if(A.indexOf("//")===0){const B=t.protocol+A;R.push(B)}else R.push(A)}}return R}function s(...S){const R=o.getElementsByTagName("meta");for(let j=0;j<R.length;j++){const x=R[j],K=["itemprop","property","name"].map(A=>x.getAttribute(A)).filter(A=>A?S.includes(A):!1);if(K.length&&K){const A=x.getAttribute("content");if(A)return A}}return""}function a(){let S=s("name","og:site_name","og:title","twitter:title");return S||(S=o.title),S}function u(){return s("description","og:description","twitter:description","keywords")}const l=a(),g=u(),w=t.origin,b=r();return{description:g,url:w,icons:b,name:l}}Uo.getWindowMetadata=Ww;function Bw(o,t=[]){const r=[];return Object.keys(o).forEach(s=>{if(t.length&&!t.includes(s))return;const a=o[s];r.push(...a.accounts)}),r}const Gw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Qw(o,t){const{message:r,code:s}=Gw[o];return{message:r,code:s}}function mo(o,t){return!!Array.isArray(o)}var Mr={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var wo=function(o,t){return wo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var a in s)s.hasOwnProperty(a)&&(r[a]=s[a])},wo(o,t)};function Jw(o,t){wo(o,t);function r(){this.constructor=o}o.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var _o=function(){return _o=Object.assign||function(t){for(var r,s=1,a=arguments.length;s<a;s++){r=arguments[s];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(t[u]=r[u])}return t},_o.apply(this,arguments)};function Yw(o,t){var r={};for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&t.indexOf(s)<0&&(r[s]=o[s]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(o);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(o,s[a])&&(r[s[a]]=o[s[a]]);return r}function Zw(o,t,r,s){var a=arguments.length,u=a<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(o,t,r,s);else for(var g=o.length-1;g>=0;g--)(l=o[g])&&(u=(a<3?l(u):a>3?l(t,r,u):l(t,r))||u);return a>3&&u&&Object.defineProperty(t,r,u),u}function Xw(o,t){return function(r,s){t(r,s,o)}}function e0(o,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,t)}function t0(o,t,r,s){function a(u){return u instanceof r?u:new r(function(l){l(u)})}return new(r||(r=Promise))(function(u,l){function g(N){try{b(s.next(N))}catch(S){l(S)}}function w(N){try{b(s.throw(N))}catch(S){l(S)}}function b(N){N.done?u(N.value):a(N.value).then(g,w)}b((s=s.apply(o,t||[])).next())})}function r0(o,t){var r={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},s,a,u,l;return l={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function g(b){return function(N){return w([b,N])}}function w(b){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,a&&(u=b[0]&2?a.return:b[0]?a.throw||((u=a.return)&&u.call(a),0):a.next)&&!(u=u.call(a,b[1])).done)return u;switch(a=0,u&&(b=[b[0]&2,u.value]),b[0]){case 0:case 1:u=b;break;case 4:return r.label++,{value:b[1],done:!1};case 5:r.label++,a=b[1],b=[0];continue;case 7:b=r.ops.pop(),r.trys.pop();continue;default:if(u=r.trys,!(u=u.length>0&&u[u.length-1])&&(b[0]===6||b[0]===2)){r=0;continue}if(b[0]===3&&(!u||b[1]>u[0]&&b[1]<u[3])){r.label=b[1];break}if(b[0]===6&&r.label<u[1]){r.label=u[1],u=b;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(b);break}u[2]&&r.ops.pop(),r.trys.pop();continue}b=t.call(o,r)}catch(N){b=[6,N],a=0}finally{s=u=0}if(b[0]&5)throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}}function i0(o,t,r,s){s===void 0&&(s=r),o[s]=t[r]}function s0(o,t){for(var r in o)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=o[r])}function bo(o){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&o[t],s=0;if(r)return r.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&s>=o.length&&(o=void 0),{value:o&&o[s++],done:!o}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fh(o,t){var r=typeof Symbol=="function"&&o[Symbol.iterator];if(!r)return o;var s=r.call(o),a,u=[],l;try{for(;(t===void 0||t-- >0)&&!(a=s.next()).done;)u.push(a.value)}catch(g){l={error:g}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(l)throw l.error}}return u}function n0(){for(var o=[],t=0;t<arguments.length;t++)o=o.concat(Fh(arguments[t]));return o}function o0(){for(var o=0,t=0,r=arguments.length;t<r;t++)o+=arguments[t].length;for(var s=Array(o),a=0,t=0;t<r;t++)for(var u=arguments[t],l=0,g=u.length;l<g;l++,a++)s[a]=u[l];return s}function bi(o){return this instanceof bi?(this.v=o,this):new bi(o)}function a0(o,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(o,t||[]),a,u=[];return a={},l("next"),l("throw"),l("return"),a[Symbol.asyncIterator]=function(){return this},a;function l(R){s[R]&&(a[R]=function(j){return new Promise(function(x,K){u.push([R,j,x,K])>1||g(R,j)})})}function g(R,j){try{w(s[R](j))}catch(x){S(u[0][3],x)}}function w(R){R.value instanceof bi?Promise.resolve(R.value.v).then(b,N):S(u[0][2],R)}function b(R){g("next",R)}function N(R){g("throw",R)}function S(R,j){R(j),u.shift(),u.length&&g(u[0][0],u[0][1])}}function c0(o){var t,r;return t={},s("next"),s("throw",function(a){throw a}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(a,u){t[a]=o[a]?function(l){return(r=!r)?{value:bi(o[a](l)),done:a==="return"}:u?u(l):l}:u}}function u0(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=o[Symbol.asyncIterator],r;return t?t.call(o):(o=typeof bo=="function"?bo(o):o[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(u){r[u]=o[u]&&function(l){return new Promise(function(g,w){l=o[u](l),a(g,w,l.done,l.value)})}}function a(u,l,g,w){Promise.resolve(w).then(function(b){u({value:b,done:g})},l)}}function h0(o,t){return Object.defineProperty?Object.defineProperty(o,"raw",{value:t}):o.raw=t,o}function l0(o){if(o&&o.__esModule)return o;var t={};if(o!=null)for(var r in o)Object.hasOwnProperty.call(o,r)&&(t[r]=o[r]);return t.default=o,t}function p0(o){return o&&o.__esModule?o:{default:o}}function d0(o,t){if(!t.has(o))throw new TypeError("attempted to get private field on non-instance");return t.get(o)}function f0(o,t,r){if(!t.has(o))throw new TypeError("attempted to set private field on non-instance");return t.set(o,r),r}const g0=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return _o},__asyncDelegator:c0,__asyncGenerator:a0,__asyncValues:u0,__await:bi,__awaiter:t0,__classPrivateFieldGet:d0,__classPrivateFieldSet:f0,__createBinding:i0,__decorate:Zw,__exportStar:s0,__extends:Jw,__generator:r0,__importDefault:p0,__importStar:l0,__makeTemplateObject:h0,__metadata:e0,__param:Xw,__read:Fh,__rest:Yw,__spread:n0,__spreadArrays:o0,__values:bo},Symbol.toStringTag,{value:"Module"})),As=xo(g0);var li={},so={},pi={};const y0=Object.freeze(Object.defineProperty({__proto__:null,IEvents:lr},Symbol.toStringTag,{value:"Module"})),v0=xo(y0);var Du;function m0(){if(Du)return pi;Du=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.IHeartBeat=void 0;const o=v0;class t extends o.IEvents{constructor(s){super()}}return pi.IHeartBeat=t,pi}var qu;function Wh(){return qu||(qu=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),As.__exportStar(m0(),o)}(so)),so}var no={},cr={},ju;function w0(){if(ju)return cr;ju=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.HEARTBEAT_EVENTS=cr.HEARTBEAT_INTERVAL=void 0;const o=q;return cr.HEARTBEAT_INTERVAL=o.FIVE_SECONDS,cr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},cr}var Uu;function Bh(){return Uu||(Uu=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),As.__exportStar(w0(),o)}(no)),no}var Mu;function _0(){if(Mu)return li;Mu=1,Object.defineProperty(li,"__esModule",{value:!0}),li.HeartBeat=void 0;const o=As,t=Iw(),r=q,s=Wh(),a=Bh();class u extends s.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||a.HEARTBEAT_INTERVAL}static init(g){return o.__awaiter(this,void 0,void 0,function*(){const w=new u(g);return yield w.init(),w})}init(){return o.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,w){this.events.on(g,w)}once(g,w){this.events.once(g,w)}off(g,w){this.events.off(g,w)}removeListener(g,w){this.events.removeListener(g,w)}initialize(){return o.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return li.HeartBeat=u,li}(function(o){Object.defineProperty(o,"__esModule",{value:!0});const t=As;t.__exportStar(_0(),o),t.__exportStar(Wh(),o),t.__exportStar(Bh(),o)})(Mr);class b0 extends lr{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let E0=class extends lr{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}};class I0{constructor(t,r){this.logger=t,this.core=r}}let P0=class extends lr{constructor(t,r){super(),this.relayer=t,this.logger=r}},S0=class extends lr{constructor(t){super()}},O0=class{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}},R0=class extends lr{constructor(t,r){super(),this.relayer=t,this.logger=r}},N0=class extends lr{constructor(t,r){super(),this.core=t,this.logger=r}},$0=class{constructor(t,r){this.projectId=t,this.logger=r}},C0=class{constructor(t,r){this.projectId=t,this.logger=r}},T0=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},x0=class{constructor(t){this.client=t}};const A0=o=>JSON.stringify(o,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),D0=o=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=o.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function q0(o){if(typeof o!="string")throw new Error(`Cannot safe json parse value of type ${typeof o}`);try{return D0(o)}catch{return o}}function j0(o){return typeof o=="string"?o:A0(o)||""}var Lu=function(o,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,u;s<a;s++)(u||!(s in t))&&(u||(u=Array.prototype.slice.call(t,0,s)),u[s]=t[s]);return o.concat(u||Array.prototype.slice.call(t))},U0=function(){function o(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return o}(),M0=function(){function o(t){this.version=t,this.type="node",this.name="node",this.os=te.process.platform}return o}(),L0=function(){function o(t,r,s,a){this.name=t,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return o}(),k0=function(){function o(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return o}(),z0=function(){function o(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return o}(),H0=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,V0=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ku=3,K0=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",H0]],zu=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function F0(o){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new z0:typeof navigator<"u"?B0(navigator.userAgent):Q0()}function W0(o){return o!==""&&K0.reduce(function(t,r){var s=r[0],a=r[1];if(t)return t;var u=a.exec(o);return!!u&&[s,u]},!1)}function B0(o){var t=W0(o);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new k0;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<ku&&(a=Lu(Lu([],a,!0),J0(ku-a.length),!0)):a=[];var u=a.join("."),l=G0(o),g=V0.exec(o);return g&&g[1]?new L0(r,u,l,g[1]):new U0(r,u,l)}function G0(o){for(var t=0,r=zu.length;t<r;t++){var s=zu[t],a=s[0],u=s[1],l=u.exec(o);if(l)return a}return null}function Q0(){var o=typeof te.process<"u"&&te.process.version;return o?new M0(te.process.version.slice(1)):null}function J0(o){for(var t=[],r=0;r<o;r++)t.push("0");return t}var ne={};Object.defineProperty(ne,"__esModule",{value:!0});ne.getLocalStorage=ne.getLocalStorageOrThrow=ne.getCrypto=ne.getCryptoOrThrow=Gh=ne.getLocation=ne.getLocationOrThrow=Lo=ne.getNavigator=ne.getNavigatorOrThrow=Mo=ne.getDocument=ne.getDocumentOrThrow=ne.getFromWindowOrThrow=ne.getFromWindow=void 0;function dr(o){let t;return typeof window<"u"&&typeof window[o]<"u"&&(t=window[o]),t}ne.getFromWindow=dr;function Lr(o){const t=dr(o);if(!t)throw new Error(`${o} is not defined in Window`);return t}ne.getFromWindowOrThrow=Lr;function Y0(){return Lr("document")}ne.getDocumentOrThrow=Y0;function Z0(){return dr("document")}var Mo=ne.getDocument=Z0;function X0(){return Lr("navigator")}ne.getNavigatorOrThrow=X0;function e_(){return dr("navigator")}var Lo=ne.getNavigator=e_;function t_(){return Lr("location")}ne.getLocationOrThrow=t_;function r_(){return dr("location")}var Gh=ne.getLocation=r_;function i_(){return Lr("crypto")}ne.getCryptoOrThrow=i_;function s_(){return dr("crypto")}ne.getCrypto=s_;function n_(){return Lr("localStorage")}ne.getLocalStorageOrThrow=n_;function o_(){return dr("localStorage")}ne.getLocalStorage=o_;var ko={};Object.defineProperty(ko,"__esModule",{value:!0});var Qh=ko.getWindowMetadata=void 0;const Hu=ne;function a_(){let o,t;try{o=Hu.getDocumentOrThrow(),t=Hu.getLocationOrThrow()}catch{return null}function r(){const S=o.getElementsByTagName("link"),R=[];for(let j=0;j<S.length;j++){const x=S[j],K=x.getAttribute("rel");if(K&&K.toLowerCase().indexOf("icon")>-1){const A=x.getAttribute("href");if(A)if(A.toLowerCase().indexOf("https:")===-1&&A.toLowerCase().indexOf("http:")===-1&&A.indexOf("//")!==0){let B=t.protocol+"//"+t.host;if(A.indexOf("/")===0)B+=A;else{const pe=t.pathname.split("/");pe.pop();const J=pe.join("/");B+=J+"/"+A}R.push(B)}else if(A.indexOf("//")===0){const B=t.protocol+A;R.push(B)}else R.push(A)}}return R}function s(...S){const R=o.getElementsByTagName("meta");for(let j=0;j<R.length;j++){const x=R[j],K=["itemprop","property","name"].map(A=>x.getAttribute(A)).filter(A=>A?S.includes(A):!1);if(K.length&&K){const A=x.getAttribute("content");if(A)return A}}return""}function a(){let S=s("name","og:site_name","og:title","twitter:title");return S||(S=o.title),S}function u(){return s("description","og:description","twitter:description","keywords")}const l=a(),g=u(),w=t.origin,b=r();return{description:g,url:w,icons:b,name:l}}Qh=ko.getWindowMetadata=a_;const c_=":";function u_(o){const[t,r]=o.split(c_);return{namespace:t,reference:r}}function Jh(o,t){return o.includes(":")?[o]:t.chains||[]}const Yh="base10",Ae="base16",Eo="base64pad",zo="utf8",Zh=0,fr=1,h_=0,Vu=1,Io=12,Ho=32;function l_(){const o=zh.generateKeyPair();return{privateKey:nt(o.secretKey,Ae),publicKey:nt(o.publicKey,Ae)}}function Po(){const o=Hh.randomBytes(Ho);return nt(o,Ae)}function p_(o,t){const r=zh.sharedKey(ft(o,Ae),ft(t,Ae),!0),s=new Ow(Do.SHA256,r).expand(Ho);return nt(s,Ae)}function d_(o){const t=Do.hash(ft(o,Ae));return nt(t,Ae)}function qr(o){const t=Do.hash(ft(o,zo));return nt(t,Ae)}function f_(o){return ft(`${o}`,Yh)}function Ii(o){return Number(nt(o,Yh))}function g_(o){const t=f_(typeof o.type<"u"?o.type:Zh);if(Ii(t)===fr&&typeof o.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof o.senderPublicKey<"u"?ft(o.senderPublicKey,Ae):void 0,s=typeof o.iv<"u"?ft(o.iv,Ae):Hh.randomBytes(Io),a=new Vh.ChaCha20Poly1305(ft(o.symKey,Ae)).seal(s,ft(o.message,zo));return v_({type:t,sealed:a,iv:s,senderPublicKey:r})}function y_(o){const t=new Vh.ChaCha20Poly1305(ft(o.symKey,Ae)),{sealed:r,iv:s}=Os(o.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return nt(a,zo)}function v_(o){if(Ii(o.type)===fr){if(typeof o.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return nt($u([o.type,o.senderPublicKey,o.iv,o.sealed]),Eo)}return nt($u([o.type,o.iv,o.sealed]),Eo)}function Os(o){const t=ft(o,Eo),r=t.slice(h_,Vu),s=Vu;if(Ii(r)===fr){const g=s+Ho,w=g+Io,b=t.slice(s,g),N=t.slice(g,w),S=t.slice(w);return{type:r,sealed:S,iv:N,senderPublicKey:b}}const a=s+Io,u=t.slice(s,a),l=t.slice(a);return{type:r,sealed:l,iv:u}}function m_(o,t){const r=Os(o);return Xh({type:Ii(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?nt(r.senderPublicKey,Ae):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Xh(o){const t=(o==null?void 0:o.type)||Zh;if(t===fr){if(typeof(o==null?void 0:o.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(o==null?void 0:o.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:o==null?void 0:o.senderPublicKey,receiverPublicKey:o==null?void 0:o.receiverPublicKey}}function Ku(o){return o.type===fr&&typeof o.senderPublicKey=="string"&&typeof o.receiverPublicKey=="string"}var w_=Object.defineProperty,Fu=Object.getOwnPropertySymbols,__=Object.prototype.hasOwnProperty,b_=Object.prototype.propertyIsEnumerable,Wu=(o,t,r)=>t in o?w_(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Bu=(o,t)=>{for(var r in t||(t={}))__.call(t,r)&&Wu(o,r,t[r]);if(Fu)for(var r of Fu(t))b_.call(t,r)&&Wu(o,r,t[r]);return o};const E_="ReactNative",Ge={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},I_="js";function Vo(){return typeof te.process<"u"&&typeof te.process.versions<"u"&&typeof te.process.versions.node<"u"}function kr(){return!Mo()&&!!Lo()&&navigator.product===E_}function zr(){return!Vo()&&!!Lo()&&!!Mo()}function Pi(){return kr()?Ge.reactNative:Vo()?Ge.node:zr()?Ge.browser:Ge.unknown}function P_(){var o;try{return kr()&&typeof te.global<"u"&&typeof(te.global==null?void 0:te.global.Application)<"u"?(o=te.global.Application)==null?void 0:o.applicationId:void 0}catch{return}}function S_(o,t){let r=Ss.parse(o);return r=Bu(Bu({},r),t),o=Ss.stringify(r),o}function O_(){return Qh()||{name:"",description:"",url:"",icons:[""]}}function R_(){if(Pi()===Ge.reactNative&&typeof te.global<"u"&&typeof(te.global==null?void 0:te.global.Platform)<"u"){const{OS:r,Version:s}=te.global.Platform;return[r,s].join("-")}const o=F0();if(o===null)return"unknown";const t=o.os?o.os.replace(" ","").toLowerCase():"unknown";return o.type==="browser"?[t,o.name,o.version].join("-"):[t,o.version].join("-")}function N_(){var o;const t=Pi();return t===Ge.browser?[t,((o=Gh())==null?void 0:o.host)||"unknown"].join(":"):t}function $_(o,t,r){const s=R_(),a=N_();return[[o,t].join("-"),[I_,r].join("-"),s,a].join("/")}function C_({protocol:o,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:u,useOnCloseEvent:l,bundleId:g}){const w=r.split("?"),b=$_(o,t,s),N={auth:a,ua:b,projectId:u,useOnCloseEvent:l||void 0,origin:g||void 0},S=S_(w[1]||"",N);return w[0]+"?"+S}function ur(o,t){return o.filter(r=>t.includes(r)).length===o.length}function el(o){return Object.fromEntries(o.entries())}function tl(o){return new Map(Object.entries(o))}function xr(o=q.FIVE_MINUTES,t){const r=q.toMiliseconds(o||q.FIVE_MINUTES);let s,a,u;return{resolve:l=>{u&&s&&(clearTimeout(u),s(l))},reject:l=>{u&&a&&(clearTimeout(u),a(l))},done:()=>new Promise((l,g)=>{u=setTimeout(()=>{g(new Error(t))},r),s=l,a=g})}}function Ei(o,t,r){return new Promise(async(s,a)=>{const u=setTimeout(()=>a(new Error(r)),t);try{const l=await o;s(l)}catch(l){a(l)}clearTimeout(u)})}function rl(o,t){if(typeof t=="string"&&t.startsWith(`${o}:`))return t;if(o.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(o.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${o}`)}function T_(o){return rl("topic",o)}function x_(o){return rl("id",o)}function il(o){const[t,r]=o.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function dt(o,t){return q.fromMiliseconds(Date.now()+q.toMiliseconds(o))}function Gt(o){return Date.now()>=q.toMiliseconds(o)}function ve(o,t){return`${o}${t?`:${t}`:""}`}function oo(o=[],t=[]){return[...new Set([...o,...t])]}async function A_({id:o,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const u=`${a}/wc?requestId=${o}&sessionTopic=${t}`,l=Pi();l===Ge.browser?u.startsWith("https://")?window.open(u,"_blank","noreferrer noopener"):window.open(u,"_self","noreferrer noopener"):l===Ge.reactNative&&typeof(te.global==null?void 0:te.global.Linking)<"u"&&await te.global.Linking.openURL(u)}catch(s){console.error(s)}}async function D_(o,t){try{return await o.getItem(t)||(zr()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}const q_="irn";function So(o){return(o==null?void 0:o.relay)||{protocol:q_}}function Is(o){const t=Rw[o];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${o}`);return t}var j_=Object.defineProperty,Gu=Object.getOwnPropertySymbols,U_=Object.prototype.hasOwnProperty,M_=Object.prototype.propertyIsEnumerable,Qu=(o,t,r)=>t in o?j_(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,L_=(o,t)=>{for(var r in t||(t={}))U_.call(t,r)&&Qu(o,r,t[r]);if(Gu)for(var r of Gu(t))M_.call(t,r)&&Qu(o,r,t[r]);return o};function k_(o,t="-"){const r={},s="relay"+t;return Object.keys(o).forEach(a=>{if(a.startsWith(s)){const u=a.replace(s,""),l=o[a];r[u]=l}}),r}function Ju(o){o=o.includes("wc://")?o.replace("wc://",""):o,o=o.includes("wc:")?o.replace("wc:",""):o;const t=o.indexOf(":"),r=o.indexOf("?")!==-1?o.indexOf("?"):void 0,s=o.substring(0,t),a=o.substring(t+1,r).split("@"),u=typeof r<"u"?o.substring(r):"",l=Ss.parse(u);return{protocol:s,topic:z_(a[0]),version:parseInt(a[1],10),symKey:l.symKey,relay:k_(l)}}function z_(o){return o.startsWith("//")?o.substring(2):o}function H_(o,t="-"){const r="relay",s={};return Object.keys(o).forEach(a=>{const u=r+t+a;o[a]&&(s[u]=o[a])}),s}function V_(o){return`${o.protocol}:${o.topic}@${o.version}?`+Ss.stringify(L_({symKey:o.symKey},H_(o.relay)))}function Hr(o){const t=[];return o.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function K_(o){const t=[];return Object.values(o).forEach(r=>{t.push(...Hr(r.accounts))}),t}function F_(o,t){const r=[];return Object.values(o).forEach(s=>{Hr(s.accounts).includes(t)&&r.push(...s.methods)}),r}function W_(o,t){const r=[];return Object.values(o).forEach(s=>{Hr(s.accounts).includes(t)&&r.push(...s.events)}),r}function B_(o,t){const r=Ps(o,t);if(r)throw new Error(r.message);const s={};for(const[a,u]of Object.entries(o))s[a]={methods:u.methods,events:u.events,chains:u.accounts.map(l=>`${l.split(":")[0]}:${l.split(":")[1]}`)};return s}function Ko(o){return o.includes(":")}function mi(o){return Ko(o)?o.split(":")[0]:o}const G_={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Q_={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function $(o,t){const{message:r,code:s}=Q_[o];return{message:t?`${r} ${t}`:r,code:s}}function ye(o,t){const{message:r,code:s}=G_[o];return{message:t?`${r} ${t}`:r,code:s}}function hr(o,t){return!!Array.isArray(o)}function jr(o){return Object.getPrototypeOf(o)===Object.prototype&&Object.keys(o).length}function ke(o){return typeof o>"u"}function be(o,t){return t&&ke(o)?!0:typeof o=="string"&&!!o.trim().length}function Fo(o,t){return typeof o=="number"&&!isNaN(o)}function J_(o,t){const{requiredNamespaces:r}=t,s=Object.keys(o.namespaces),a=Object.keys(r);let u=!0;return ur(a,s)?(s.forEach(l=>{const{accounts:g,methods:w,events:b}=o.namespaces[l],N=Hr(g),S=r[l];(!ur(Jh(l,S),N)||!ur(S.methods,w)||!ur(S.events,b))&&(u=!1)}),u):!1}function Rs(o){return be(o,!1)&&o.includes(":")?o.split(":").length===2:!1}function Y_(o){if(be(o,!1)&&o.includes(":")){const t=o.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Rs(r)}}return!1}function Z_(o){if(be(o,!1))try{return typeof new URL(o)<"u"}catch{return!1}return!1}function X_(o){var t;return(t=o==null?void 0:o.proposer)==null?void 0:t.publicKey}function eb(o){return o==null?void 0:o.topic}function tb(o,t){let r=null;return be(o==null?void 0:o.publicKey,!1)||(r=$("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Yu(o){let t=!0;return hr(o)?o.length&&(t=o.every(r=>be(r,!1))):t=!1,t}function rb(o,t,r){let s=null;return hr(t)&&t.length?t.forEach(a=>{s||Rs(a)||(s=ye("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Rs(o)||(s=ye("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function ib(o,t,r){let s=null;return Object.entries(o).forEach(([a,u])=>{if(s)return;const l=rb(a,Jh(a,u),`${t} ${r}`);l&&(s=l)}),s}function sb(o,t){let r=null;return hr(o)?o.forEach(s=>{r||Y_(s)||(r=ye("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=ye("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function nb(o,t){let r=null;return Object.values(o).forEach(s=>{if(r)return;const a=sb(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function ob(o,t){let r=null;return Yu(o==null?void 0:o.methods)?Yu(o==null?void 0:o.events)||(r=ye("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=ye("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function sl(o,t){let r=null;return Object.values(o).forEach(s=>{if(r)return;const a=ob(s,`${t}, namespace`);a&&(r=a)}),r}function ab(o,t,r){let s=null;if(o&&jr(o)){const a=sl(o,t);a&&(s=a);const u=ib(o,t,r);u&&(s=u)}else s=$("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Ps(o,t){let r=null;if(o&&jr(o)){const s=sl(o,t);s&&(r=s);const a=nb(o,t);a&&(r=a)}else r=$("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function nl(o){return be(o.protocol,!0)}function cb(o,t){let r=!1;return o?o&&hr(o)&&o.length&&o.forEach(s=>{r=nl(s)}):r=!0,r}function ub(o){return typeof o=="number"}function Le(o){return typeof o<"u"&&typeof o!==null}function hb(o){return!(!o||typeof o!="object"||!o.code||!Fo(o.code)||!o.message||!be(o.message,!1))}function lb(o){return!(ke(o)||!be(o.method,!1))}function pb(o){return!(ke(o)||ke(o.result)&&ke(o.error)||!Fo(o.id)||!be(o.jsonrpc,!1))}function db(o){return!(ke(o)||!be(o.name,!1))}function Zu(o,t){return!(!Rs(t)||!K_(o).includes(t))}function fb(o,t,r){return be(r,!1)?F_(o,t).includes(r):!1}function gb(o,t,r){return be(r,!1)?W_(o,t).includes(r):!1}function Xu(o,t,r){let s=null;const a=yb(o),u=vb(t),l=Object.keys(a),g=Object.keys(u),w=eh(Object.keys(o)),b=eh(Object.keys(t)),N=w.filter(S=>!b.includes(S));return N.length&&(s=$("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${N.toString()}
      Received: ${Object.keys(t).toString()}`)),ur(l,g)||(s=$("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${l.toString()}
      Approved: ${g.toString()}`)),Object.keys(t).forEach(S=>{if(!S.includes(":")||s)return;const R=Hr(t[S].accounts);R.includes(S)||(s=$("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${S}
        Required: ${S}
        Approved: ${R.toString()}`))}),l.forEach(S=>{s||(ur(a[S].methods,u[S].methods)?ur(a[S].events,u[S].events)||(s=$("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${S}`)):s=$("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${S}`))}),s}function yb(o){const t={};return Object.keys(o).forEach(r=>{var s;r.includes(":")?t[r]=o[r]:(s=o[r].chains)==null||s.forEach(a=>{t[a]={methods:o[r].methods,events:o[r].events}})}),t}function eh(o){return[...new Set(o.map(t=>t.includes(":")?t.split(":")[0]:t))]}function vb(o){const t={};return Object.keys(o).forEach(r=>{if(r.includes(":"))t[r]=o[r];else{const s=Hr(o[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:o[r].accounts.filter(u=>u.includes(`${a}:`)),methods:o[r].methods,events:o[r].events}})}}),t}function mb(o,t){return Fo(o)&&o<=t.max&&o>=t.min}function th(){const o=Pi();return new Promise(t=>{switch(o){case Ge.browser:t(wb());break;case Ge.reactNative:t(_b());break;case Ge.node:t(bb());break;default:t(!0)}})}function wb(){return zr()&&(navigator==null?void 0:navigator.onLine)}async function _b(){if(kr()&&typeof te.global<"u"&&te.global!=null&&te.global.NetInfo){const o=await(te.global==null?void 0:te.global.NetInfo.fetch());return o==null?void 0:o.isConnected}return!0}function bb(){return!0}function Eb(o){switch(Pi()){case Ge.browser:Ib(o);break;case Ge.reactNative:Pb(o);break}}function Ib(o){!kr()&&zr()&&(window.addEventListener("online",()=>o(!0)),window.addEventListener("offline",()=>o(!1)))}function Pb(o){var t;kr()&&typeof te.global<"u"&&te.global!=null&&te.global.NetInfo&&((t=te.global)==null||t.NetInfo.addEventListener(r=>o(r==null?void 0:r.isConnected)))}const ao={};let ws=class{static get(t){return ao[t]}static set(t,r){ao[t]=r}static delete(t){delete ao[t]}};class Dt extends Nw{constructor(t){super(t),this.events=new bt.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Dr(t.method,t.params||[],t.id||Kh().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(u){a(u)}this.events.on(`${t.id}`,u=>{_t(u)?a(u.error):s(u.result)});try{await this.connection.send(t,r)}catch(u){a(u)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),$s(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}function Sb(o,t){return t=t||{},new Promise(function(r,s){var a=new XMLHttpRequest,u=[],l=[],g={},w=function(){return{ok:(a.status/100|0)==2,statusText:a.statusText,status:a.status,url:a.responseURL,text:function(){return Promise.resolve(a.responseText)},json:function(){return Promise.resolve(a.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([a.response]))},clone:w,headers:{keys:function(){return u},entries:function(){return l},get:function(N){return g[N.toLowerCase()]},has:function(N){return N.toLowerCase()in g}}}};for(var b in a.open(t.method||"get",o,!0),a.onload=function(){a.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(N,S,R){u.push(S=S.toLowerCase()),l.push([S,R]),g[S]=g[S]?g[S]+","+R:R}),r(w())},a.onerror=s,a.withCredentials=t.credentials=="include",t.headers)a.setRequestHeader(b,t.headers[b]);a.send(t.body||null)})}const Ob=Object.freeze(Object.defineProperty({__proto__:null,default:Sb},Symbol.toStringTag,{value:"Module"})),rh=xo(Ob);var Rb=self.fetch||(self.fetch=rh.default||rh);const Nb=Pw(Rb);var $b={};function Cb(o,t){if(o.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<o.length;a++){var u=o.charAt(a),l=u.charCodeAt(0);if(r[l]!==255)throw new TypeError(u+" is ambiguous");r[l]=a}var g=o.length,w=o.charAt(0),b=Math.log(g)/Math.log(256),N=Math.log(256)/Math.log(g);function S(x){if(x instanceof Uint8Array||(ArrayBuffer.isView(x)?x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength):Array.isArray(x)&&(x=Uint8Array.from(x))),!(x instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(x.length===0)return"";for(var K=0,A=0,B=0,pe=x.length;B!==pe&&x[B]===0;)B++,K++;for(var J=(pe-B)*N+1>>>0,Y=new Uint8Array(J);B!==pe;){for(var ae=x[B],Ne=0,de=J-1;(ae!==0||Ne<A)&&de!==-1;de--,Ne++)ae+=256*Y[de]>>>0,Y[de]=ae%g>>>0,ae=ae/g>>>0;if(ae!==0)throw new Error("Non-zero carry");A=Ne,B++}for(var $e=J-A;$e!==J&&Y[$e]===0;)$e++;for(var jt=w.repeat(K);$e<J;++$e)jt+=o.charAt(Y[$e]);return jt}function R(x){if(typeof x!="string")throw new TypeError("Expected String");if(x.length===0)return new Uint8Array;var K=0;if(x[K]!==" "){for(var A=0,B=0;x[K]===w;)A++,K++;for(var pe=(x.length-K)*b+1>>>0,J=new Uint8Array(pe);x[K];){var Y=r[x.charCodeAt(K)];if(Y===255)return;for(var ae=0,Ne=pe-1;(Y!==0||ae<B)&&Ne!==-1;Ne--,ae++)Y+=g*J[Ne]>>>0,J[Ne]=Y%256>>>0,Y=Y/256>>>0;if(Y!==0)throw new Error("Non-zero carry");B=ae,K++}if(x[K]!==" "){for(var de=pe-B;de!==pe&&J[de]===0;)de++;for(var $e=new Uint8Array(A+(pe-de)),jt=A;de!==pe;)$e[jt++]=J[de++];return $e}}}function j(x){var K=R(x);if(K)return K;throw new Error(`Non-${t} character`)}return{encode:S,decodeUnsafe:R,decode:j}}var Tb=Cb,xb=Tb;const ol=o=>{if(o instanceof Uint8Array&&o.constructor.name==="Uint8Array")return o;if(o instanceof ArrayBuffer)return new Uint8Array(o);if(ArrayBuffer.isView(o))return new Uint8Array(o.buffer,o.byteOffset,o.byteLength);throw new Error("Unknown type, must be binary type")},Ab=o=>new TextEncoder().encode(o),Db=o=>new TextDecoder().decode(o);class qb{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class jb{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return al(this,t)}}class Ub{constructor(t){this.decoders=t}or(t){return al(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const al=(o,t)=>new Ub({...o.decoders||{[o.prefix]:o},...t.decoders||{[t.prefix]:t}});class Mb{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new qb(t,r,s),this.decoder=new jb(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ds=({name:o,prefix:t,encode:r,decode:s})=>new Mb(o,t,r,s),Si=({prefix:o,name:t,alphabet:r})=>{const{encode:s,decode:a}=xb(r,t);return Ds({prefix:o,name:t,encode:s,decode:u=>ol(a(u))})},Lb=(o,t,r,s)=>{const a={};for(let N=0;N<t.length;++N)a[t[N]]=N;let u=o.length;for(;o[u-1]==="=";)--u;const l=new Uint8Array(u*r/8|0);let g=0,w=0,b=0;for(let N=0;N<u;++N){const S=a[o[N]];if(S===void 0)throw new SyntaxError(`Non-${s} character`);w=w<<r|S,g+=r,g>=8&&(g-=8,l[b++]=255&w>>g)}if(g>=r||255&w<<8-g)throw new SyntaxError("Unexpected end of data");return l},kb=(o,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let u="",l=0,g=0;for(let w=0;w<o.length;++w)for(g=g<<8|o[w],l+=8;l>r;)l-=r,u+=t[a&g>>l];if(l&&(u+=t[a&g<<r-l]),s)for(;u.length*r&7;)u+="=";return u},Pe=({name:o,prefix:t,bitsPerChar:r,alphabet:s})=>Ds({prefix:t,name:o,encode(a){return kb(a,s,r)},decode(a){return Lb(a,s,r,o)}}),zb=Ds({prefix:"\0",name:"identity",encode:o=>Db(o),decode:o=>Ab(o)});var Hb=Object.freeze({__proto__:null,identity:zb});const Vb=Pe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Kb=Object.freeze({__proto__:null,base2:Vb});const Fb=Pe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Wb=Object.freeze({__proto__:null,base8:Fb});const Bb=Si({prefix:"9",name:"base10",alphabet:"0123456789"});var Gb=Object.freeze({__proto__:null,base10:Bb});const Qb=Pe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Jb=Pe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Yb=Object.freeze({__proto__:null,base16:Qb,base16upper:Jb});const Zb=Pe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Xb=Pe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),e1=Pe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),t1=Pe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),r1=Pe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),i1=Pe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),s1=Pe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),n1=Pe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),o1=Pe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var a1=Object.freeze({__proto__:null,base32:Zb,base32upper:Xb,base32pad:e1,base32padupper:t1,base32hex:r1,base32hexupper:i1,base32hexpad:s1,base32hexpadupper:n1,base32z:o1});const c1=Si({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),u1=Si({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var h1=Object.freeze({__proto__:null,base36:c1,base36upper:u1});const l1=Si({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),p1=Si({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var d1=Object.freeze({__proto__:null,base58btc:l1,base58flickr:p1});const f1=Pe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),g1=Pe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),y1=Pe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),v1=Pe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var m1=Object.freeze({__proto__:null,base64:f1,base64pad:g1,base64url:y1,base64urlpad:v1});const cl=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),w1=cl.reduce((o,t,r)=>(o[r]=t,o),[]),_1=cl.reduce((o,t,r)=>(o[t.codePointAt(0)]=r,o),[]);function b1(o){return o.reduce((t,r)=>(t+=w1[r],t),"")}function E1(o){const t=[];for(const r of o){const s=_1[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const I1=Ds({prefix:"🚀",name:"base256emoji",encode:b1,decode:E1});var P1=Object.freeze({__proto__:null,base256emoji:I1}),S1=ul,ih=128,O1=127,R1=~O1,N1=Math.pow(2,31);function ul(o,t,r){t=t||[],r=r||0;for(var s=r;o>=N1;)t[r++]=o&255|ih,o/=128;for(;o&R1;)t[r++]=o&255|ih,o>>>=7;return t[r]=o|0,ul.bytes=r-s+1,t}var $1=Oo,C1=128,sh=127;function Oo(o,s){var r=0,s=s||0,a=0,u=s,l,g=o.length;do{if(u>=g)throw Oo.bytes=0,new RangeError("Could not decode varint");l=o[u++],r+=a<28?(l&sh)<<a:(l&sh)*Math.pow(2,a),a+=7}while(l>=C1);return Oo.bytes=u-s,r}var T1=Math.pow(2,7),x1=Math.pow(2,14),A1=Math.pow(2,21),D1=Math.pow(2,28),q1=Math.pow(2,35),j1=Math.pow(2,42),U1=Math.pow(2,49),M1=Math.pow(2,56),L1=Math.pow(2,63),k1=function(o){return o<T1?1:o<x1?2:o<A1?3:o<D1?4:o<q1?5:o<j1?6:o<U1?7:o<M1?8:o<L1?9:10},z1={encode:S1,decode:$1,encodingLength:k1},hl=z1;const nh=(o,t,r=0)=>(hl.encode(o,t,r),t),oh=o=>hl.encodingLength(o),Ro=(o,t)=>{const r=t.byteLength,s=oh(o),a=s+oh(r),u=new Uint8Array(a+r);return nh(o,u,0),nh(r,u,s),u.set(t,a),new H1(o,r,t,u)};class H1{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const ll=({name:o,code:t,encode:r})=>new V1(o,t,r);class V1{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Ro(this.code,r):r.then(s=>Ro(this.code,s))}else throw Error("Unknown type, must be binary type")}}const pl=o=>async t=>new Uint8Array(await crypto.subtle.digest(o,t)),K1=ll({name:"sha2-256",code:18,encode:pl("SHA-256")}),F1=ll({name:"sha2-512",code:19,encode:pl("SHA-512")});var W1=Object.freeze({__proto__:null,sha256:K1,sha512:F1});const dl=0,B1="identity",fl=ol,G1=o=>Ro(dl,fl(o)),Q1={code:dl,name:B1,encode:fl,digest:G1};var J1=Object.freeze({__proto__:null,identity:Q1});new TextEncoder,new TextDecoder;const ah={...Hb,...Kb,...Wb,...Gb,...Yb,...a1,...h1,...d1,...m1,...P1};({...W1,...J1});function gl(o){return globalThis.Buffer!=null?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):o}function Y1(o=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?gl(globalThis.Buffer.allocUnsafe(o)):new Uint8Array(o)}function yl(o,t,r,s){return{name:o,prefix:t,encoder:{name:o,prefix:t,encode:r},decoder:{decode:s}}}const ch=yl("utf8","u",o=>"u"+new TextDecoder("utf8").decode(o),o=>new TextEncoder().encode(o.substring(1))),co=yl("ascii","a",o=>{let t="a";for(let r=0;r<o.length;r++)t+=String.fromCharCode(o[r]);return t},o=>{o=o.substring(1);const t=Y1(o.length);for(let r=0;r<o.length;r++)t[r]=o.charCodeAt(r);return t}),Z1={utf8:ch,"utf-8":ch,hex:ah.base16,latin1:co,ascii:co,binary:co,...ah};function X1(o,t="utf8"){const r=Z1[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?gl(globalThis.Buffer.from(o,"utf-8")):r.decoder.decode(`${r.prefix}${o}`)}const vl="wc",eE=2,Wo="core",Qt=`${vl}@2:${Wo}:`,tE={name:Wo,logger:"error"},rE={database:":memory:"},iE="crypto",uh="client_ed25519_seed",sE=q.ONE_DAY,nE="keychain",oE="0.3",aE="messages",cE="0.3",uE=q.SIX_HOURS,hE="publisher",ml="irn",lE="error",wl="wss://relay.walletconnect.com",hh="wss://relay.walletconnect.org",pE="relayer",Re={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},dE="_subscription",xt={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},fE=q.ONE_SECOND,gE="2.11.0",yE=1e4,vE="0.3",mE="WALLETCONNECT_CLIENT_ID",pt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},wE="subscription",_E="0.3",bE=q.FIVE_SECONDS*1e3,EE="pairing",IE="0.3",di={wc_pairingDelete:{req:{ttl:q.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:q.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:q.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:q.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:q.ONE_DAY,prompt:!1,tag:0},res:{ttl:q.ONE_DAY,prompt:!1,tag:0}}},wi={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},wt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},PE="history",SE="0.3",OE="expirer",st={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},RE="0.3",uo="verify-api",Ar="https://verify.walletconnect.com",No="https://verify.walletconnect.org",NE=[Ar,No],$E="echo",CE="https://echo.walletconnect.com";class TE{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=nE,this.version=oE,this.initialized=!1,this.storagePrefix=Qt,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:u}=$("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(u)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=ze(r,this.name)}get context(){return Qe(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,el(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?tl(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=$("NOT_INITIALIZED",this.name);throw new Error(t)}}}class xE{constructor(t,r,s){this.core=t,this.logger=r,this.name=iE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),u=Cu(a);return Tw(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=l_();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const u=await this.getClientSeed(),l=Cu(u),g=Po();return await xw(g,a,sE,l)},this.generateSharedKey=(a,u,l)=>{this.isInitialized();const g=this.getPrivateKey(a),w=p_(g,u);return this.setSymKey(w,l)},this.setSymKey=async(a,u)=>{this.isInitialized();const l=u||d_(a);return await this.keychain.set(l,a),l},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,u,l)=>{this.isInitialized();const g=Xh(l),w=j0(u);if(Ku(g)){const R=g.senderPublicKey,j=g.receiverPublicKey;a=await this.generateSharedKey(R,j)}const b=this.getSymKey(a),{type:N,senderPublicKey:S}=g;return g_({type:N,symKey:b,message:w,senderPublicKey:S})},this.decode=async(a,u,l)=>{this.isInitialized();const g=m_(u,l);if(Ku(g)){const w=g.receiverPublicKey,b=g.senderPublicKey;a=await this.generateSharedKey(w,b)}try{const w=this.getSymKey(a),b=y_({symKey:w,encoded:u});return q0(b)}catch(w){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(w)}},this.getPayloadType=a=>{const u=Os(a);return Ii(u.type)},this.getPayloadSenderPublicKey=a=>{const u=Os(a);return u.senderPublicKey?nt(u.senderPublicKey,Ae):void 0},this.core=t,this.logger=ze(r,this.name),this.keychain=s||new TE(this.core,this.logger)}get context(){return Qe(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(uh)}catch{t=Po(),await this.keychain.set(uh,t)}return X1(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=$("NOT_INITIALIZED",this.name);throw new Error(t)}}}class AE extends I0{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=aE,this.version=cE,this.initialized=!1,this.storagePrefix=Qt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const u=qr(a);let l=this.messages.get(s);return typeof l>"u"&&(l={}),typeof l[u]<"u"||(l[u]=a,this.messages.set(s,l),await this.persist()),u},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const u=this.get(s),l=qr(a);return typeof u[l]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=ze(t,this.name),this.core=r}get context(){return Qe(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,el(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?tl(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=$("NOT_INITIALIZED",this.name);throw new Error(t)}}}class DE extends P0{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new bt.EventEmitter,this.name=hE,this.queue=new Map,this.publishTimeout=q.toMiliseconds(q.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,u)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}});try{const g=(u==null?void 0:u.ttl)||uE,w=So(u),b=(u==null?void 0:u.prompt)||!1,N=(u==null?void 0:u.tag)||0,S=(u==null?void 0:u.id)||Kh().toString(),R={topic:s,message:a,opts:{ttl:g,relay:w,prompt:b,tag:N,id:S}},j=setTimeout(()=>this.queue.set(S,R),this.publishTimeout);try{await await Ei(this.rpcPublish(s,a,g,w,b,N,S),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(S),this.relayer.events.emit(Re.publish,R)}catch(x){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=u==null?void 0:u.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(S),x;return}finally{clearTimeout(j)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=ze(r,this.name),this.registerEventListeners()}get context(){return Qe(this.logger)}rpcPublish(t,r,s,a,u,l,g){var w,b,N,S;const R={method:Is(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:u,tag:l},id:g};return ke((w=R.params)==null?void 0:w.prompt)&&((b=R.params)==null||delete b.prompt),ke((N=R.params)==null?void 0:N.tag)&&((S=R.params)==null||delete S.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:R}),this.relayer.request(R)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Mr.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Re.connection_stalled);return}this.checkQueue()}),this.relayer.on(Re.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class qE{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(u=>u!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var jE=Object.defineProperty,UE=Object.defineProperties,ME=Object.getOwnPropertyDescriptors,lh=Object.getOwnPropertySymbols,LE=Object.prototype.hasOwnProperty,kE=Object.prototype.propertyIsEnumerable,ph=(o,t,r)=>t in o?jE(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,fi=(o,t)=>{for(var r in t||(t={}))LE.call(t,r)&&ph(o,r,t[r]);if(lh)for(var r of lh(t))kE.call(t,r)&&ph(o,r,t[r]);return o},ho=(o,t)=>UE(o,ME(t));class zE extends R0{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new qE,this.events=new bt.EventEmitter,this.name=wE,this.version=_E,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Qt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const u=So(a),l={topic:s,relay:u};this.pending.set(s,l);const g=await this.rpcSubscribe(s,u);return this.onSubscribe(g,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),g}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,u)=>{const l=new q.Watch;l.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),l.stop(this.pendingSubscriptionWatchLabel),a(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=bE&&(clearInterval(g),l.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=ze(r,this.name),this.clientId=""}get context(){return Qe(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=So(s);await this.rpcUnsubscribe(t,r,a);const u=ye("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:Is(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Ei(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Re.connection_stalled)}return qr(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Is(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Ei(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Re.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:Is(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,ho(fi({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,fi({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,fi({},r)),this.topicMap.set(r.topic,t),this.events.emit(pt.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=$("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(pt.deleted,ho(fi({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(pt.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(pt.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=$("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);hr(r)&&this.onBatchSubscribe(r.map((s,a)=>ho(fi({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Mr.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Re.connect,async()=>{await this.onConnect()}),this.relayer.on(Re.disconnect,()=>{this.onDisconnect()}),this.events.on(pt.created,async t=>{const r=pt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(pt.deleted,async t=>{const r=pt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=$("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var HE=Object.defineProperty,dh=Object.getOwnPropertySymbols,VE=Object.prototype.hasOwnProperty,KE=Object.prototype.propertyIsEnumerable,fh=(o,t,r)=>t in o?HE(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,FE=(o,t)=>{for(var r in t||(t={}))VE.call(t,r)&&fh(o,r,t[r]);if(dh)for(var r of dh(t))KE.call(t,r)&&fh(o,r,t[r]);return o};class WE extends S0{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new bt.EventEmitter,this.name=pE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Re.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Re.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(xt.payload,this.onPayloadHandler),this.provider.on(xt.connect,this.onConnectHandler),this.provider.on(xt.disconnect,this.onDisconnectHandler),this.provider.on(xt.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?ze(t.logger,this.name):Cs(Ts({level:t.logger||lE})),this.messages=new AE(this.logger,t.core),this.subscriber=new zE(this,this.logger),this.publisher=new DE(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||wl,this.projectId=t.projectId,this.bundleId=P_(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${hh}...`),await this.restartTransport(hh)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},yE)}get context(){return Qe(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(a)return a;let u;const l=g=>{g.topic===t&&(this.subscriber.off(pt.created,l),u())};return await Promise.all([new Promise(g=>{u=g,this.subscriber.on(pt.created,l)}),new Promise(async g=>{a=await this.subscriber.subscribe(t,r),g()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Ei(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(pt.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await Ei(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(xt.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await th())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Dt(new Aw(C_({sdkVersion:gE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),qo(t)){if(!t.method.endsWith(dE))return;const r=t.params,{topic:s,message:a,publishedAt:u}=r.data,l={topic:s,message:a,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(FE({type:"event",event:r.id},l)),this.events.emit(r.id,l),await this.acknowledgePayload(t),await this.onMessageEvent(l)}else $s(t)&&this.events.emit(Re.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Re.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=xs(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(xt.payload,this.onPayloadHandler),this.provider.off(xt.connect,this.onConnectHandler),this.provider.off(xt.disconnect,this.onDisconnectHandler),this.provider.off(xt.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Re.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await th();Eb(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Re.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},q.toMiliseconds(fE)))}isInitialized(){if(!this.initialized){const{message:t}=$("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var BE=Object.defineProperty,gh=Object.getOwnPropertySymbols,GE=Object.prototype.hasOwnProperty,QE=Object.prototype.propertyIsEnumerable,yh=(o,t,r)=>t in o?BE(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,vh=(o,t)=>{for(var r in t||(t={}))GE.call(t,r)&&yh(o,r,t[r]);if(gh)for(var r of gh(t))QE.call(t,r)&&yh(o,r,t[r]);return o};class qs extends O0{constructor(t,r,s,a=Qt,u=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=vE,this.cached=[],this.initialized=!1,this.storagePrefix=Qt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!ke(l)?this.map.set(this.getKey(l),l):X_(l)?this.map.set(l.id,l):eb(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,g)=>{this.isInitialized(),this.map.has(l)?await this.update(l,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:g}),this.map.set(l,g),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(g=>Object.keys(l).every(w=>$w(g[w],l[w]))):this.values),this.update=async(l,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:g});const w=vh(vh({},this.getData(l)),g);this.map.set(l,w),await this.persist()},this.delete=async(l,g)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:g}),this.map.delete(l),await this.persist())},this.logger=ze(r,this.name),this.storagePrefix=a,this.getKey=u}get context(){return Qe(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=$("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=$("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=$("NOT_INITIALIZED",this.name);throw new Error(t)}}}class JE{constructor(t,r){this.core=t,this.logger=r,this.name=EE,this.version=IE,this.events=new Ao,this.initialized=!1,this.storagePrefix=Qt,this.ignoredPayloadTypes=[fr],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Po(),a=await this.core.crypto.setSymKey(s),u=dt(q.FIVE_MINUTES),l={protocol:ml},g={topic:a,expiry:u,relay:l,active:!1},w=V_({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:l});return await this.pairings.set(a,g),await this.core.relayer.subscribe(a),this.core.expirer.set(a,u),{topic:a,uri:w}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:u,relay:l}=Ju(s.uri);let g;if(this.pairings.keys.includes(a)&&(g=this.pairings.get(a),g.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const w=dt(q.FIVE_MINUTES),b={topic:a,relay:l,expiry:w,active:!1};return await this.pairings.set(a,b),this.core.expirer.set(a,w),s.activatePairing&&await this.activate({topic:a}),this.events.emit(wi.create,b),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(u,a),await this.core.relayer.subscribe(a,{relay:l})),b},this.activate=async({topic:s})=>{this.isInitialized();const a=dt(q.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const u=await this.sendRequest(a,"wc_pairingPing",{}),{done:l,resolve:g,reject:w}=xr();this.events.once(ve("pairing_ping",u),({error:b})=>{b?w(b):g()}),await l()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",ye("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,u)=>{const l=Dr(a,u),g=await this.core.crypto.encode(s,l),w=di[a].req;return this.core.history.set(s,l),this.core.relayer.publish(s,g,w),l.id},this.sendResult=async(s,a,u)=>{const l=xs(s,u),g=await this.core.crypto.encode(a,l),w=await this.core.history.get(a,s),b=di[w.request.method].res;await this.core.relayer.publish(a,g,b),await this.core.history.resolve(l)},this.sendError=async(s,a,u)=>{const l=jo(s,u),g=await this.core.crypto.encode(a,l),w=await this.core.history.get(a,s),b=di[w.request.method]?di[w.request.method].res:di.unregistered_method.res;await this.core.relayer.publish(a,g,b),await this.core.history.resolve(l)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,ye("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Gt(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:u}=s;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(a,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,u);default:return this.onUnknownRpcMethodRequest(a,u)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:u}=s,l=(await this.core.history.get(a,u.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(a,u);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(s,a)=>{const{id:u}=a;try{this.isValidPing({topic:s}),await this.sendResult(u,s,!0),this.events.emit(wi.ping,{id:u,topic:s})}catch(l){await this.sendError(u,s,l),this.logger.error(l)}},this.onPairingPingResponse=(s,a)=>{const{id:u}=a;setTimeout(()=>{Bt(a)?this.events.emit(ve("pairing_ping",u),{}):_t(a)&&this.events.emit(ve("pairing_ping",u),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:u}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(wi.delete,{id:u,topic:s})}catch(l){await this.sendError(u,s,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:u,method:l}=a;try{if(this.registeredMethods.includes(l))return;const g=ye("WC_METHOD_UNSUPPORTED",l);await this.sendError(u,s,g),this.logger.error(g)}catch(g){await this.sendError(u,s,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(ye("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var a;if(!Le(s)){const{message:l}=$("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(l)}if(!Z_(s.uri)){const{message:l}=$("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(l)}const u=Ju(s.uri);if(!((a=u==null?void 0:u.relay)!=null&&a.protocol)){const{message:l}=$("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(l)}if(!(u!=null&&u.symKey)){const{message:l}=$("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(l)}},this.isValidPing=async s=>{if(!Le(s)){const{message:u}=$("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!Le(s)){const{message:u}=$("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!be(s,!1)){const{message:a}=$("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=$("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Gt(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=$("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=ze(r,this.name),this.pairings=new qs(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qe(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=$("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Re.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{qo(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):$s(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(st.expired,async t=>{const{topic:r}=il(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(wi.expire,{topic:r}))})}}class YE extends E0{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new bt.EventEmitter,this.name=PE,this.version=SE,this.cached=[],this.initialized=!1,this.storagePrefix=Qt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:u}),this.records.has(a.id))return;const l={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:u,expiry:dt(q.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(wt.created,l)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=_t(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(wt.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(u=>{if(u.topic===s){if(typeof a<"u"&&u.id!==a)return;this.records.delete(u.id),this.events.emit(wt.deleted,u)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=ze(r,this.name)}get context(){return Qe(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Dr(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=$("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(wt.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=$("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(wt.created,t=>{const r=wt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(wt.updated,t=>{const r=wt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(wt.deleted,t=>{const r=wt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Mr.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{q.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=$("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ZE extends N0{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new bt.EventEmitter,this.name=OE,this.version=RE,this.cached=[],this.initialized=!1,this.storagePrefix=Qt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const u=this.formatTarget(s),l={target:u,expiry:a};this.expirations.set(u,l),this.checkExpiry(u,l),this.events.emit(st.created,{target:u,expiration:l})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),u=this.getExpiration(a);this.expirations.delete(a),this.events.emit(st.deleted,{target:a,expiration:u})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=ze(r,this.name)}get context(){return Qe(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return T_(t);if(typeof t=="number")return x_(t);const{message:r}=$("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(st.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=$("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=$("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;q.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(st.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Mr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(st.created,t=>{const r=st.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(st.expired,t=>{const r=st.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(st.deleted,t=>{const r=st.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=$("NOT_INITIALIZED",this.name);throw new Error(t)}}}class XE extends $0{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=uo,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||kr()||!zr())return;const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u)}if(!this.initialized){this.removeIframe(),this.verifyUrl=No;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let u;try{u=await this.fetchAttestation(s.attestationId,a)}catch(l){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(l),u=await this.fetchAttestation(s.attestationId,No)}return u},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const u=this.startAbortTimer(q.ONE_SECOND*2),l=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(u),l.status===200?await l.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=u=>{u.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(u=>{if(document.getElementById(uo))return u();window.addEventListener("message",a);const l=document.createElement("iframe");l.id=uo,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,s=u}),new Promise((u,l)=>setTimeout(()=>{window.removeEventListener("message",a),l("verify iframe load timeout")},q.toMiliseconds(q.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let a=s||Ar;return NE.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${Ar}`),a=Ar),a},this.logger=ze(r,this.name),this.verifyUrl=Ar,this.abortController=new AbortController,this.isDevEnv=Vo()&&$b.IS_VITEST}get context(){return Qe(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),q.toMiliseconds(t))}}class eI extends C0{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=$E,this.registerDeviceToken=async s=>{const{clientId:a,token:u,notificationType:l,enableEncrypted:g=!1}=s,w=`${CE}/${this.projectId}/clients`;await Nb(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:a,type:l,token:u,always_raw:g})})},this.logger=ze(r,this.context)}}var tI=Object.defineProperty,mh=Object.getOwnPropertySymbols,rI=Object.prototype.hasOwnProperty,iI=Object.prototype.propertyIsEnumerable,wh=(o,t,r)=>t in o?tI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,_h=(o,t)=>{for(var r in t||(t={}))rI.call(t,r)&&wh(o,r,t[r]);if(mh)for(var r of mh(t))iI.call(t,r)&&wh(o,r,t[r]);return o};class Bo extends b0{constructor(t){super(t),this.protocol=vl,this.version=eE,this.name=Wo,this.events=new bt.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||wl,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Cs(Ts({level:(t==null?void 0:t.logger)||tE.logger}));this.logger=ze(r,this.name),this.heartbeat=new Mr.HeartBeat,this.crypto=new xE(this,this.logger,t==null?void 0:t.keychain),this.history=new YE(this,this.logger),this.expirer=new ZE(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Cw(_h(_h({},rE),t==null?void 0:t.storageOptions)),this.relayer=new WE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new JE(this,this.logger),this.verify=new XE(this.projectId||"",this.logger),this.echoClient=new eI(this.projectId||"",this.logger)}static async init(t){const r=new Bo(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(mE,s),r}get context(){return Qe(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const sI=Bo,_l="wc",bl=2,El="client",Go=`${_l}@${bl}:${El}:`,lo={name:El,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},bh="WALLETCONNECT_DEEPLINK_CHOICE",nI="proposal",Il="Proposal expired",oI="session",_s=q.SEVEN_DAYS,aI="engine",gi={wc_sessionPropose:{req:{ttl:q.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:q.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:q.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:q.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:q.ONE_DAY,prompt:!1,tag:1104},res:{ttl:q.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:q.ONE_DAY,prompt:!1,tag:1106},res:{ttl:q.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:q.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:q.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:q.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:q.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:q.ONE_DAY,prompt:!1,tag:1112},res:{ttl:q.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:q.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:q.THIRTY_SECONDS,prompt:!1,tag:1115}}},po={min:q.FIVE_MINUTES,max:q.SEVEN_DAYS},At={idle:"IDLE",active:"ACTIVE"},cI="request",uI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var hI=Object.defineProperty,lI=Object.defineProperties,pI=Object.getOwnPropertyDescriptors,Eh=Object.getOwnPropertySymbols,dI=Object.prototype.hasOwnProperty,fI=Object.prototype.propertyIsEnumerable,Ih=(o,t,r)=>t in o?hI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Me=(o,t)=>{for(var r in t||(t={}))dI.call(t,r)&&Ih(o,r,t[r]);if(Eh)for(var r of Eh(t))fI.call(t,r)&&Ih(o,r,t[r]);return o},yi=(o,t)=>lI(o,pI(t));class gI extends x0{constructor(t){super(t),this.name=aI,this.events=new Ao,this.initialized=!1,this.ignoredPayloadTypes=[fr],this.requestQueue={state:At.idle,queue:[]},this.sessionRequestQueue={state:At.idle,queue:[]},this.requestQueueDelay=q.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(gi)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},q.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=yi(Me({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:u,optionalNamespaces:l,sessionProperties:g,relays:w}=s;let b=a,N,S=!1;if(b&&(S=this.client.core.pairing.pairings.get(b).active),!b||!S){const{topic:J,uri:Y}=await this.client.core.pairing.create();b=J,N=Y}const R=await this.client.core.crypto.generateKeyPair(),j=Me({requiredNamespaces:u,optionalNamespaces:l,relays:w??[{protocol:ml}],proposer:{publicKey:R,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:x,resolve:K,done:A}=xr(q.FIVE_MINUTES,Il);if(this.events.once(ve("session_connect"),async({error:J,session:Y})=>{if(J)x(J);else if(Y){Y.self.publicKey=R;const ae=yi(Me({},Y),{requiredNamespaces:Y.requiredNamespaces,optionalNamespaces:Y.optionalNamespaces});await this.client.session.set(Y.topic,ae),await this.setExpiry(Y.topic,Y.expiry),b&&await this.client.core.pairing.updateMetadata({topic:b,metadata:Y.peer.metadata}),K(ae)}}),!b){const{message:J}=$("NO_MATCHING_KEY",`connect() pairing topic: ${b}`);throw new Error(J)}const B=await this.sendRequest({topic:b,method:"wc_sessionPropose",params:j}),pe=dt(q.FIVE_MINUTES);return await this.setProposal(B,Me({id:B,expiry:pe},j)),{uri:N,approval:A}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:u,sessionProperties:l}=r,g=this.client.proposal.get(s);let{pairingTopic:w,proposer:b,requiredNamespaces:N,optionalNamespaces:S}=g;w=w||"",jr(N)||(N=B_(u,"approve()"));const R=await this.client.core.crypto.generateKeyPair(),j=b.publicKey,x=await this.client.core.crypto.generateSharedKey(R,j);w&&s&&(await this.client.core.pairing.updateMetadata({topic:w,metadata:b.metadata}),await this.sendResult({id:s,topic:w,result:{relay:{protocol:a??"irn"},responderPublicKey:R}}),await this.client.proposal.delete(s,ye("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}));const K=Me({relay:{protocol:a??"irn"},namespaces:u,requiredNamespaces:N,optionalNamespaces:S,pairingTopic:w,controller:{publicKey:R,metadata:this.client.metadata},expiry:dt(_s)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(x),await this.sendRequest({topic:x,method:"wc_sessionSettle",params:K,throwOnFailedPublish:!0});const A=yi(Me({},K),{topic:x,pairingTopic:w,acknowledged:!1,self:K.controller,peer:{publicKey:b.publicKey,metadata:b.metadata},controller:R});return await this.client.session.set(x,A),await this.setExpiry(x,dt(_s)),{topic:x,acknowledged:()=>new Promise(B=>setTimeout(()=>B(this.client.session.get(x)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:u}=this.client.proposal.get(s);u&&(await this.sendError(s,u,a),await this.client.proposal.delete(s,ye("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,u=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:l,resolve:g,reject:w}=xr();return this.events.once(ve("session_update",u),({error:b})=>{b?w(b):g()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:l}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:u,resolve:l,reject:g}=xr();return this.events.once(ve("session_extend",a),({error:w})=>{w?g(w):l()}),await this.setExpiry(s,dt(_s)),{acknowledged:u}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:u,expiry:l}=r,g=Dw(),{done:w,resolve:b,reject:N}=xr(l,"Request expired. Please try again.");return this.events.once(ve("session_request",g),({error:S,result:R})=>{S?N(S):b(R)}),await Promise.all([new Promise(async S=>{await this.sendRequest({clientRpcId:g,topic:u,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:l,throwOnFailedPublish:!0}).catch(R=>N(R)),this.client.events.emit("session_request_sent",{topic:u,request:a,chainId:s,id:g}),S()}),new Promise(async S=>{const R=await D_(this.client.core.storage,bh);A_({id:g,topic:u,wcDeepLink:R}),S()}),w()]).then(S=>S[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:u}=a;Bt(a)?await this.sendResult({id:u,topic:s,result:a.result,throwOnFailedPublish:!0}):_t(a)&&await this.sendError(u,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:u,resolve:l,reject:g}=xr();this.events.once(ve("session_ping",a),({error:w})=>{w?g(w):l()}),await u()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:u}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:u}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:ye("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>J_(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(u=>{var l,g;return((l=u.peerMetadata)==null?void 0:l.url)&&((g=u.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&u.topic&&u.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,ye("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(bh).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===r&&this.deletePendingSessionRequest(u.id,ye("USER_DISCONNECTED"))})},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,ye("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(u=>u.id!==r),a&&(this.sessionRequestQueue.state=At.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=gi.wc_sessionRequest.req.ttl,{id:a,topic:u,params:l,verifyContext:g}=r;await this.client.pendingRequest.set(a,{id:a,topic:u,params:l,verifyContext:g}),s&&this.client.core.expirer.set(a,dt(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:u,expiry:l,relayRpcId:g,clientRpcId:w,throwOnFailedPublish:b}=r,N=Dr(a,u,w);if(zr()&&uI.includes(a)){const j=qr(JSON.stringify(N));this.client.core.verify.register({attestationId:j})}const S=await this.client.core.crypto.encode(s,N),R=gi[a].req;return l&&(R.ttl=l),g&&(R.id=g),this.client.core.history.set(s,N),b?(R.internal=yi(Me({},R.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,S,R)):this.client.core.relayer.publish(s,S,R).catch(j=>this.client.logger.error(j)),N.id},this.sendResult=async r=>{const{id:s,topic:a,result:u,throwOnFailedPublish:l}=r,g=xs(s,u),w=await this.client.core.crypto.encode(a,g),b=await this.client.core.history.get(a,s),N=gi[b.request.method].res;l?(N.internal=yi(Me({},N.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,w,N)):this.client.core.relayer.publish(a,w,N).catch(S=>this.client.logger.error(S)),await this.client.core.history.resolve(g)},this.sendError=async(r,s,a)=>{const u=jo(r,a),l=await this.client.core.crypto.encode(s,u),g=await this.client.core.history.get(s,r),w=gi[g.request.method].res;this.client.core.relayer.publish(s,l,w),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Gt(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Gt(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===At.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=At.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=At.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,u=a.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,u=(await this.client.core.history.get(s,a.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=$("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:u}=s;try{this.isValidConnect(Me({},s.params));const l=dt(q.FIVE_MINUTES),g=Me({id:u,pairingTopic:r,expiry:l},a);await this.setProposal(u,g);const w=qr(JSON.stringify(s)),b=await this.getVerifyContext(w,g.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:g,verifyContext:b})}catch(l){await this.sendError(u,r,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(Bt(s)){const{result:u}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const l=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const g=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const w=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:w});const b=await this.client.core.crypto.generateSharedKey(g,w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:b});const N=await this.client.core.relayer.subscribe(b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:N}),await this.client.core.pairing.activate({topic:r})}else _t(s)&&(await this.client.proposal.delete(a,ye("USER_DISCONNECTED")),this.events.emit(ve("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:u}=s;try{this.isValidSessionSettleRequest(u);const{relay:l,controller:g,expiry:w,namespaces:b,requiredNamespaces:N,optionalNamespaces:S,sessionProperties:R,pairingTopic:j}=s.params,x=Me({topic:r,relay:l,expiry:w,namespaces:b,acknowledged:!0,pairingTopic:j,requiredNamespaces:N,optionalNamespaces:S,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},R&&{sessionProperties:R});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(ve("session_connect"),{session:x}),this.cleanupDuplicatePairings(x)}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;Bt(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(ve("session_approve",a),{})):_t(s)&&(await this.client.session.delete(r,ye("USER_DISCONNECTED")),this.events.emit(ve("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:u}=s;try{const l=`${r}_session_update`,g=ws.get(l);if(g&&this.isRequestOutOfSync(g,u)){this.client.logger.info(`Discarding out of sync request - ${u}`);return}this.isValidUpdate(Me({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:u,topic:r,result:!0}),this.client.events.emit("session_update",{id:u,topic:r,params:a}),ws.set(l,u)}catch(l){await this.sendError(u,r,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;Bt(s)?this.events.emit(ve("session_update",a),{}):_t(s)&&this.events.emit(ve("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,dt(_s)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;Bt(s)?this.events.emit(ve("session_extend",a),{}):_t(s)&&this.events.emit(ve("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{Bt(s)?this.events.emit(ve("session_ping",a),{}):_t(s)&&this.events.emit(ve("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once(Re.publish,async()=>{u(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(u){this.client.logger.error(u)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:u}=s;try{this.isValidRequest(Me({topic:r},u));const l=qr(JSON.stringify(Dr("wc_sessionRequest",u,a))),g=this.client.session.get(r),w=await this.getVerifyContext(l,g.peer.metadata),b={id:a,topic:r,params:u,verifyContext:w};await this.setPendingSessionRequest(b),this.addSessionRequestToSessionRequestQueue(b),this.processSessionRequestQueue()}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;Bt(s)?this.events.emit(ve("session_request",a),{result:s.result}):_t(s)&&this.events.emit(ve("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:u}=s;try{const l=`${r}_session_event_${u.event.name}`,g=ws.get(l);if(g&&this.isRequestOutOfSync(g,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(Me({topic:r},u)),this.client.events.emit("session_event",{id:a,topic:r,params:u}),ws.set(l,a)}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=At.idle,this.processSessionRequestQueue()},q.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===At.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=At.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,Dr("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!Le(r)){const{message:w}=$("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(w)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:l,relays:g}=r;if(ke(s)||await this.isValidPairingTopic(s),!cb(g)){const{message:w}=$("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(w)}!ke(a)&&jr(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!ke(u)&&jr(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),ke(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=ab(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!Le(r))throw new Error($("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:u,sessionProperties:l}=r;await this.isValidProposalId(s);const g=this.client.proposal.get(s),w=Ps(a,"approve()");if(w)throw new Error(w.message);const b=Xu(g.requiredNamespaces,a,"approve()");if(b)throw new Error(b.message);if(!be(u,!0)){const{message:N}=$("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(N)}ke(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async r=>{if(!Le(r)){const{message:u}=$("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(u)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!hb(a)){const{message:u}=$("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidSessionSettleRequest=r=>{if(!Le(r)){const{message:b}=$("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(b)}const{relay:s,controller:a,namespaces:u,expiry:l}=r;if(!nl(s)){const{message:b}=$("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(b)}const g=tb(a,"onSessionSettleRequest()");if(g)throw new Error(g.message);const w=Ps(u,"onSessionSettleRequest()");if(w)throw new Error(w.message);if(Gt(l)){const{message:b}=$("EXPIRED","onSessionSettleRequest()");throw new Error(b)}},this.isValidUpdate=async r=>{if(!Le(r)){const{message:w}=$("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(w)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const u=this.client.session.get(s),l=Ps(a,"update()");if(l)throw new Error(l.message);const g=Xu(u.requiredNamespaces,a,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!Le(r)){const{message:a}=$("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!Le(r)){const{message:w}=$("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(w)}const{topic:s,request:a,chainId:u,expiry:l}=r;await this.isValidSessionTopic(s);const{namespaces:g}=this.client.session.get(s);if(!Zu(g,u)){const{message:w}=$("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(w)}if(!lb(a)){const{message:w}=$("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(w)}if(!fb(g,u,a.method)){const{message:w}=$("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(w)}if(l&&!mb(l,po)){const{message:w}=$("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${po.min} and ${po.max}`);throw new Error(w)}},this.isValidRespond=async r=>{var s;if(!Le(r)){const{message:l}=$("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:a,response:u}=r;try{await this.isValidSessionTopic(a)}catch(l){throw(s=r==null?void 0:r.response)!=null&&s.id&&this.cleanupAfterResponse(r),l}if(!pb(u)){const{message:l}=$("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(u)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!Le(r)){const{message:a}=$("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!Le(r)){const{message:g}=$("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:s,event:a,chainId:u}=r;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!Zu(l,u)){const{message:g}=$("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(g)}if(!db(a)){const{message:g}=$("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}if(!gb(l,u,a.name)){const{message:g}=$("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!Le(r)){const{message:a}=$("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||Ar,validation:"UNKNOWN",origin:s.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});u&&(a.verified.origin=u.origin,a.verified.isScam=u.isScam,a.verified.validation=u.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.info(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!be(a,!1)){const{message:u}=$("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(u)}})}}async isInitialized(){if(!this.initialized){const{message:t}=$("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Re.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{qo(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):$s(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(u){this.client.logger.error(u)}})}registerExpirerEvents(){this.client.core.expirer.on(st.expired,async t=>{const{topic:r,id:s}=il(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,$("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(wi.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!be(t,!1)){const{message:r}=$("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=$("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Gt(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=$("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!be(t,!1)){const{message:r}=$("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=$("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Gt(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=$("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(be(t,!1)){const{message:r}=$("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=$("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!ub(t)){const{message:r}=$("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=$("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Gt(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=$("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class yI extends qs{constructor(t,r){super(t,r,nI,Go),this.core=t,this.logger=r}}class vI extends qs{constructor(t,r){super(t,r,oI,Go),this.core=t,this.logger=r}}class mI extends qs{constructor(t,r){super(t,r,cI,Go,s=>s.id),this.core=t,this.logger=r}}let wI=class Pl extends T0{constructor(t){super(t),this.protocol=_l,this.version=bl,this.name=lo.name,this.events=new bt.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||lo.name,this.metadata=(t==null?void 0:t.metadata)||O_();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Cs(Ts({level:(t==null?void 0:t.logger)||lo.logger}));this.core=(t==null?void 0:t.core)||new sI(t),this.logger=ze(r,this.name),this.session=new vI(this.core,this.logger),this.proposal=new yI(this.core,this.logger),this.pendingRequest=new mI(this.core,this.logger),this.engine=new gI(this)}static async init(t){const r=new Pl(t);return await r.initialize(),r}get context(){return Qe(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};const _I=o=>JSON.stringify(o,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),bI=o=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=o.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function EI(o){if(typeof o!="string")throw new Error(`Cannot safe json parse value of type ${typeof o}`);try{return bI(o)}catch{return o}}function Ph(o){return typeof o=="string"?o:_I(o)||""}var II=Object.defineProperty,PI=Object.defineProperties,SI=Object.getOwnPropertyDescriptors,Sh=Object.getOwnPropertySymbols,OI=Object.prototype.hasOwnProperty,RI=Object.prototype.propertyIsEnumerable,Oh=(o,t,r)=>t in o?II(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Rh=(o,t)=>{for(var r in t||(t={}))OI.call(t,r)&&Oh(o,r,t[r]);if(Sh)for(var r of Sh(t))RI.call(t,r)&&Oh(o,r,t[r]);return o},Nh=(o,t)=>PI(o,SI(t));const NI={Accept:"application/json","Content-Type":"application/json"},$I="POST",$h={headers:NI,method:$I},Ch=10;let Yt=class{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new bt.EventEmitter,this.isAvailable=!1,this.registering=!1,!Tu(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const r=Ph(t),s=await(await xu(this.url,Nh(Rh({},$h),{body:r}))).json();this.onPayload({data:s})}catch(r){this.onError(t.id,r)}}async register(t=this.url){if(!Tu(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Ph({id:1,jsonrpc:"2.0",method:"test",params:[]});await xu(t,Nh(Rh({},$h),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?EI(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),u=jo(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return qw(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Ch&&this.events.setMaxListeners(Ch)}};const Th="error",CI="wss://relay.walletconnect.com",TI="wc",xI="universal_provider",xh=`${TI}@2:${xI}:`,AI="https://rpc.walletconnect.com/v1/",qt={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var vi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof te.global<"u"?te.global:typeof self<"u"?self:{},$o={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(o,t){(function(){var r,s="4.17.21",a=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",g="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",b=500,N="__lodash_placeholder__",S=1,R=2,j=4,x=1,K=2,A=1,B=2,pe=4,J=8,Y=16,ae=32,Ne=64,de=128,$e=256,jt=512,Rl=30,Nl="...",$l=800,Cl=16,Yo=1,Tl=2,xl=3,Zt=1/0,Ut=9007199254740991,Al=17976931348623157e292,Oi=NaN,gt=4294967295,Dl=gt-1,ql=gt>>>1,jl=[["ary",de],["bind",A],["bindKey",B],["curry",J],["curryRight",Y],["flip",jt],["partial",ae],["partialRight",Ne],["rearg",$e]],yr="[object Arguments]",Ri="[object Array]",Ul="[object AsyncFunction]",Vr="[object Boolean]",Kr="[object Date]",Ml="[object DOMException]",Ni="[object Error]",$i="[object Function]",Zo="[object GeneratorFunction]",ot="[object Map]",Fr="[object Number]",Ll="[object Null]",Et="[object Object]",Xo="[object Promise]",kl="[object Proxy]",Wr="[object RegExp]",at="[object Set]",Br="[object String]",Ci="[object Symbol]",zl="[object Undefined]",Gr="[object WeakMap]",Hl="[object WeakSet]",Qr="[object ArrayBuffer]",vr="[object DataView]",js="[object Float32Array]",Us="[object Float64Array]",Ms="[object Int8Array]",Ls="[object Int16Array]",ks="[object Int32Array]",zs="[object Uint8Array]",Hs="[object Uint8ClampedArray]",Vs="[object Uint16Array]",Ks="[object Uint32Array]",Vl=/\b__p \+= '';/g,Kl=/\b(__p \+=) '' \+/g,Fl=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ea=/&(?:amp|lt|gt|quot|#39);/g,ta=/[&<>"']/g,Wl=RegExp(ea.source),Bl=RegExp(ta.source),Gl=/<%-([\s\S]+?)%>/g,Ql=/<%([\s\S]+?)%>/g,ra=/<%=([\s\S]+?)%>/g,Jl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yl=/^\w*$/,Zl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Fs=/[\\^$.*+?()[\]{}|]/g,Xl=RegExp(Fs.source),Ws=/^\s+/,ep=/\s/,tp=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,rp=/\{\n\/\* \[wrapped with (.+)\] \*/,ip=/,? & /,sp=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,np=/[()=,{}\[\]\/\s]/,op=/\\(\\)?/g,ap=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ia=/\w*$/,cp=/^[-+]0x[0-9a-f]+$/i,up=/^0b[01]+$/i,hp=/^\[object .+?Constructor\]$/,lp=/^0o[0-7]+$/i,pp=/^(?:0|[1-9]\d*)$/,dp=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ti=/($^)/,fp=/['\n\r\u2028\u2029\\]/g,xi="\\ud800-\\udfff",gp="\\u0300-\\u036f",yp="\\ufe20-\\ufe2f",vp="\\u20d0-\\u20ff",sa=gp+yp+vp,na="\\u2700-\\u27bf",oa="a-z\\xdf-\\xf6\\xf8-\\xff",mp="\\xac\\xb1\\xd7\\xf7",wp="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",_p="\\u2000-\\u206f",bp=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",aa="A-Z\\xc0-\\xd6\\xd8-\\xde",ca="\\ufe0e\\ufe0f",ua=mp+wp+_p+bp,Bs="['’]",Ep="["+xi+"]",ha="["+ua+"]",Ai="["+sa+"]",la="\\d+",Ip="["+na+"]",pa="["+oa+"]",da="[^"+xi+ua+la+na+oa+aa+"]",Gs="\\ud83c[\\udffb-\\udfff]",Pp="(?:"+Ai+"|"+Gs+")",fa="[^"+xi+"]",Qs="(?:\\ud83c[\\udde6-\\uddff]){2}",Js="[\\ud800-\\udbff][\\udc00-\\udfff]",mr="["+aa+"]",ga="\\u200d",ya="(?:"+pa+"|"+da+")",Sp="(?:"+mr+"|"+da+")",va="(?:"+Bs+"(?:d|ll|m|re|s|t|ve))?",ma="(?:"+Bs+"(?:D|LL|M|RE|S|T|VE))?",wa=Pp+"?",_a="["+ca+"]?",Op="(?:"+ga+"(?:"+[fa,Qs,Js].join("|")+")"+_a+wa+")*",Rp="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Np="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ba=_a+wa+Op,$p="(?:"+[Ip,Qs,Js].join("|")+")"+ba,Cp="(?:"+[fa+Ai+"?",Ai,Qs,Js,Ep].join("|")+")",Tp=RegExp(Bs,"g"),xp=RegExp(Ai,"g"),Ys=RegExp(Gs+"(?="+Gs+")|"+Cp+ba,"g"),Ap=RegExp([mr+"?"+pa+"+"+va+"(?="+[ha,mr,"$"].join("|")+")",Sp+"+"+ma+"(?="+[ha,mr+ya,"$"].join("|")+")",mr+"?"+ya+"+"+va,mr+"+"+ma,Np,Rp,la,$p].join("|"),"g"),Dp=RegExp("["+ga+xi+sa+ca+"]"),qp=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,jp=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Up=-1,oe={};oe[js]=oe[Us]=oe[Ms]=oe[Ls]=oe[ks]=oe[zs]=oe[Hs]=oe[Vs]=oe[Ks]=!0,oe[yr]=oe[Ri]=oe[Qr]=oe[Vr]=oe[vr]=oe[Kr]=oe[Ni]=oe[$i]=oe[ot]=oe[Fr]=oe[Et]=oe[Wr]=oe[at]=oe[Br]=oe[Gr]=!1;var ie={};ie[yr]=ie[Ri]=ie[Qr]=ie[vr]=ie[Vr]=ie[Kr]=ie[js]=ie[Us]=ie[Ms]=ie[Ls]=ie[ks]=ie[ot]=ie[Fr]=ie[Et]=ie[Wr]=ie[at]=ie[Br]=ie[Ci]=ie[zs]=ie[Hs]=ie[Vs]=ie[Ks]=!0,ie[Ni]=ie[$i]=ie[Gr]=!1;var Mp={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Lp={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},kp={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},zp={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Hp=parseFloat,Vp=parseInt,Ea=typeof vi=="object"&&vi&&vi.Object===Object&&vi,Kp=typeof self=="object"&&self&&self.Object===Object&&self,Ee=Ea||Kp||Function("return this")(),Zs=t&&!t.nodeType&&t,Xt=Zs&&!0&&o&&!o.nodeType&&o,Ia=Xt&&Xt.exports===Zs,Xs=Ia&&Ea.process,Je=function(){try{var v=Xt&&Xt.require&&Xt.require("util").types;return v||Xs&&Xs.binding&&Xs.binding("util")}catch{}}(),Pa=Je&&Je.isArrayBuffer,Sa=Je&&Je.isDate,Oa=Je&&Je.isMap,Ra=Je&&Je.isRegExp,Na=Je&&Je.isSet,$a=Je&&Je.isTypedArray;function He(v,E,_){switch(_.length){case 0:return v.call(E);case 1:return v.call(E,_[0]);case 2:return v.call(E,_[0],_[1]);case 3:return v.call(E,_[0],_[1],_[2])}return v.apply(E,_)}function Fp(v,E,_,T){for(var k=-1,Z=v==null?0:v.length;++k<Z;){var me=v[k];E(T,me,_(me),v)}return T}function Ye(v,E){for(var _=-1,T=v==null?0:v.length;++_<T&&E(v[_],_,v)!==!1;);return v}function Wp(v,E){for(var _=v==null?0:v.length;_--&&E(v[_],_,v)!==!1;);return v}function Ca(v,E){for(var _=-1,T=v==null?0:v.length;++_<T;)if(!E(v[_],_,v))return!1;return!0}function Mt(v,E){for(var _=-1,T=v==null?0:v.length,k=0,Z=[];++_<T;){var me=v[_];E(me,_,v)&&(Z[k++]=me)}return Z}function Di(v,E){var _=v==null?0:v.length;return!!_&&wr(v,E,0)>-1}function en(v,E,_){for(var T=-1,k=v==null?0:v.length;++T<k;)if(_(E,v[T]))return!0;return!1}function ce(v,E){for(var _=-1,T=v==null?0:v.length,k=Array(T);++_<T;)k[_]=E(v[_],_,v);return k}function Lt(v,E){for(var _=-1,T=E.length,k=v.length;++_<T;)v[k+_]=E[_];return v}function tn(v,E,_,T){var k=-1,Z=v==null?0:v.length;for(T&&Z&&(_=v[++k]);++k<Z;)_=E(_,v[k],k,v);return _}function Bp(v,E,_,T){var k=v==null?0:v.length;for(T&&k&&(_=v[--k]);k--;)_=E(_,v[k],k,v);return _}function rn(v,E){for(var _=-1,T=v==null?0:v.length;++_<T;)if(E(v[_],_,v))return!0;return!1}var Gp=sn("length");function Qp(v){return v.split("")}function Jp(v){return v.match(sp)||[]}function Ta(v,E,_){var T;return _(v,function(k,Z,me){if(E(k,Z,me))return T=Z,!1}),T}function qi(v,E,_,T){for(var k=v.length,Z=_+(T?1:-1);T?Z--:++Z<k;)if(E(v[Z],Z,v))return Z;return-1}function wr(v,E,_){return E===E?cd(v,E,_):qi(v,xa,_)}function Yp(v,E,_,T){for(var k=_-1,Z=v.length;++k<Z;)if(T(v[k],E))return k;return-1}function xa(v){return v!==v}function Aa(v,E){var _=v==null?0:v.length;return _?on(v,E)/_:Oi}function sn(v){return function(E){return E==null?r:E[v]}}function nn(v){return function(E){return v==null?r:v[E]}}function Da(v,E,_,T,k){return k(v,function(Z,me,re){_=T?(T=!1,Z):E(_,Z,me,re)}),_}function Zp(v,E){var _=v.length;for(v.sort(E);_--;)v[_]=v[_].value;return v}function on(v,E){for(var _,T=-1,k=v.length;++T<k;){var Z=E(v[T]);Z!==r&&(_=_===r?Z:_+Z)}return _}function an(v,E){for(var _=-1,T=Array(v);++_<v;)T[_]=E(_);return T}function Xp(v,E){return ce(E,function(_){return[_,v[_]]})}function qa(v){return v&&v.slice(0,La(v)+1).replace(Ws,"")}function Ve(v){return function(E){return v(E)}}function cn(v,E){return ce(E,function(_){return v[_]})}function Jr(v,E){return v.has(E)}function ja(v,E){for(var _=-1,T=v.length;++_<T&&wr(E,v[_],0)>-1;);return _}function Ua(v,E){for(var _=v.length;_--&&wr(E,v[_],0)>-1;);return _}function ed(v,E){for(var _=v.length,T=0;_--;)v[_]===E&&++T;return T}var td=nn(Mp),rd=nn(Lp);function id(v){return"\\"+zp[v]}function sd(v,E){return v==null?r:v[E]}function _r(v){return Dp.test(v)}function nd(v){return qp.test(v)}function od(v){for(var E,_=[];!(E=v.next()).done;)_.push(E.value);return _}function un(v){var E=-1,_=Array(v.size);return v.forEach(function(T,k){_[++E]=[k,T]}),_}function Ma(v,E){return function(_){return v(E(_))}}function kt(v,E){for(var _=-1,T=v.length,k=0,Z=[];++_<T;){var me=v[_];(me===E||me===N)&&(v[_]=N,Z[k++]=_)}return Z}function ji(v){var E=-1,_=Array(v.size);return v.forEach(function(T){_[++E]=T}),_}function ad(v){var E=-1,_=Array(v.size);return v.forEach(function(T){_[++E]=[T,T]}),_}function cd(v,E,_){for(var T=_-1,k=v.length;++T<k;)if(v[T]===E)return T;return-1}function ud(v,E,_){for(var T=_+1;T--;)if(v[T]===E)return T;return T}function br(v){return _r(v)?ld(v):Gp(v)}function ct(v){return _r(v)?pd(v):Qp(v)}function La(v){for(var E=v.length;E--&&ep.test(v.charAt(E)););return E}var hd=nn(kp);function ld(v){for(var E=Ys.lastIndex=0;Ys.test(v);)++E;return E}function pd(v){return v.match(Ys)||[]}function dd(v){return v.match(Ap)||[]}var fd=function v(E){E=E==null?Ee:Er.defaults(Ee.Object(),E,Er.pick(Ee,jp));var _=E.Array,T=E.Date,k=E.Error,Z=E.Function,me=E.Math,re=E.Object,hn=E.RegExp,gd=E.String,Ze=E.TypeError,Ui=_.prototype,yd=Z.prototype,Ir=re.prototype,Mi=E["__core-js_shared__"],Li=yd.toString,ee=Ir.hasOwnProperty,vd=0,ka=function(){var e=/[^.]+$/.exec(Mi&&Mi.keys&&Mi.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ki=Ir.toString,md=Li.call(re),wd=Ee._,_d=hn("^"+Li.call(ee).replace(Fs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zi=Ia?E.Buffer:r,zt=E.Symbol,Hi=E.Uint8Array,za=zi?zi.allocUnsafe:r,Vi=Ma(re.getPrototypeOf,re),Ha=re.create,Va=Ir.propertyIsEnumerable,Ki=Ui.splice,Ka=zt?zt.isConcatSpreadable:r,Yr=zt?zt.iterator:r,er=zt?zt.toStringTag:r,Fi=function(){try{var e=nr(re,"defineProperty");return e({},"",{}),e}catch{}}(),bd=E.clearTimeout!==Ee.clearTimeout&&E.clearTimeout,Ed=T&&T.now!==Ee.Date.now&&T.now,Id=E.setTimeout!==Ee.setTimeout&&E.setTimeout,Wi=me.ceil,Bi=me.floor,ln=re.getOwnPropertySymbols,Pd=zi?zi.isBuffer:r,Fa=E.isFinite,Sd=Ui.join,Od=Ma(re.keys,re),we=me.max,Se=me.min,Rd=T.now,Nd=E.parseInt,Wa=me.random,$d=Ui.reverse,pn=nr(E,"DataView"),Zr=nr(E,"Map"),dn=nr(E,"Promise"),Pr=nr(E,"Set"),Xr=nr(E,"WeakMap"),ei=nr(re,"create"),Gi=Xr&&new Xr,Sr={},Cd=or(pn),Td=or(Zr),xd=or(dn),Ad=or(Pr),Dd=or(Xr),Qi=zt?zt.prototype:r,ti=Qi?Qi.valueOf:r,Ba=Qi?Qi.toString:r;function p(e){if(le(e)&&!z(e)&&!(e instanceof G)){if(e instanceof Xe)return e;if(ee.call(e,"__wrapped__"))return Gc(e)}return new Xe(e)}var Or=function(){function e(){}return function(i){if(!he(i))return{};if(Ha)return Ha(i);e.prototype=i;var n=new e;return e.prototype=r,n}}();function Ji(){}function Xe(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}p.templateSettings={escape:Gl,evaluate:Ql,interpolate:ra,variable:"",imports:{_:p}},p.prototype=Ji.prototype,p.prototype.constructor=p,Xe.prototype=Or(Ji.prototype),Xe.prototype.constructor=Xe;function G(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=gt,this.__views__=[]}function qd(){var e=new G(this.__wrapped__);return e.__actions__=De(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=De(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=De(this.__views__),e}function jd(){if(this.__filtered__){var e=new G(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Ud(){var e=this.__wrapped__.value(),i=this.__dir__,n=z(e),c=i<0,h=n?e.length:0,d=Jf(0,h,this.__views__),f=d.start,y=d.end,m=y-f,I=c?y:f-1,P=this.__iteratees__,O=P.length,C=0,D=Se(m,this.__takeCount__);if(!n||!c&&h==m&&D==m)return vc(e,this.__actions__);var M=[];e:for(;m--&&C<D;){I+=i;for(var V=-1,L=e[I];++V<O;){var W=P[V],Q=W.iteratee,We=W.type,xe=Q(L);if(We==Tl)L=xe;else if(!xe){if(We==Yo)continue e;break e}}M[C++]=L}return M}G.prototype=Or(Ji.prototype),G.prototype.constructor=G;function tr(e){var i=-1,n=e==null?0:e.length;for(this.clear();++i<n;){var c=e[i];this.set(c[0],c[1])}}function Md(){this.__data__=ei?ei(null):{},this.size=0}function Ld(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function kd(e){var i=this.__data__;if(ei){var n=i[e];return n===w?r:n}return ee.call(i,e)?i[e]:r}function zd(e){var i=this.__data__;return ei?i[e]!==r:ee.call(i,e)}function Hd(e,i){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ei&&i===r?w:i,this}tr.prototype.clear=Md,tr.prototype.delete=Ld,tr.prototype.get=kd,tr.prototype.has=zd,tr.prototype.set=Hd;function It(e){var i=-1,n=e==null?0:e.length;for(this.clear();++i<n;){var c=e[i];this.set(c[0],c[1])}}function Vd(){this.__data__=[],this.size=0}function Kd(e){var i=this.__data__,n=Yi(i,e);if(n<0)return!1;var c=i.length-1;return n==c?i.pop():Ki.call(i,n,1),--this.size,!0}function Fd(e){var i=this.__data__,n=Yi(i,e);return n<0?r:i[n][1]}function Wd(e){return Yi(this.__data__,e)>-1}function Bd(e,i){var n=this.__data__,c=Yi(n,e);return c<0?(++this.size,n.push([e,i])):n[c][1]=i,this}It.prototype.clear=Vd,It.prototype.delete=Kd,It.prototype.get=Fd,It.prototype.has=Wd,It.prototype.set=Bd;function Pt(e){var i=-1,n=e==null?0:e.length;for(this.clear();++i<n;){var c=e[i];this.set(c[0],c[1])}}function Gd(){this.size=0,this.__data__={hash:new tr,map:new(Zr||It),string:new tr}}function Qd(e){var i=us(this,e).delete(e);return this.size-=i?1:0,i}function Jd(e){return us(this,e).get(e)}function Yd(e){return us(this,e).has(e)}function Zd(e,i){var n=us(this,e),c=n.size;return n.set(e,i),this.size+=n.size==c?0:1,this}Pt.prototype.clear=Gd,Pt.prototype.delete=Qd,Pt.prototype.get=Jd,Pt.prototype.has=Yd,Pt.prototype.set=Zd;function rr(e){var i=-1,n=e==null?0:e.length;for(this.__data__=new Pt;++i<n;)this.add(e[i])}function Xd(e){return this.__data__.set(e,w),this}function ef(e){return this.__data__.has(e)}rr.prototype.add=rr.prototype.push=Xd,rr.prototype.has=ef;function ut(e){var i=this.__data__=new It(e);this.size=i.size}function tf(){this.__data__=new It,this.size=0}function rf(e){var i=this.__data__,n=i.delete(e);return this.size=i.size,n}function sf(e){return this.__data__.get(e)}function nf(e){return this.__data__.has(e)}function of(e,i){var n=this.__data__;if(n instanceof It){var c=n.__data__;if(!Zr||c.length<a-1)return c.push([e,i]),this.size=++n.size,this;n=this.__data__=new Pt(c)}return n.set(e,i),this.size=n.size,this}ut.prototype.clear=tf,ut.prototype.delete=rf,ut.prototype.get=sf,ut.prototype.has=nf,ut.prototype.set=of;function Ga(e,i){var n=z(e),c=!n&&ar(e),h=!n&&!c&&Wt(e),d=!n&&!c&&!h&&Cr(e),f=n||c||h||d,y=f?an(e.length,gd):[],m=y.length;for(var I in e)(i||ee.call(e,I))&&!(f&&(I=="length"||h&&(I=="offset"||I=="parent")||d&&(I=="buffer"||I=="byteLength"||I=="byteOffset")||Nt(I,m)))&&y.push(I);return y}function Qa(e){var i=e.length;return i?e[Pn(0,i-1)]:r}function af(e,i){return hs(De(e),ir(i,0,e.length))}function cf(e){return hs(De(e))}function fn(e,i,n){(n!==r&&!ht(e[i],n)||n===r&&!(i in e))&&St(e,i,n)}function ri(e,i,n){var c=e[i];(!(ee.call(e,i)&&ht(c,n))||n===r&&!(i in e))&&St(e,i,n)}function Yi(e,i){for(var n=e.length;n--;)if(ht(e[n][0],i))return n;return-1}function uf(e,i,n,c){return Ht(e,function(h,d,f){i(c,h,n(h),f)}),c}function Ja(e,i){return e&&vt(i,_e(i),e)}function hf(e,i){return e&&vt(i,je(i),e)}function St(e,i,n){i=="__proto__"&&Fi?Fi(e,i,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[i]=n}function gn(e,i){for(var n=-1,c=i.length,h=_(c),d=e==null;++n<c;)h[n]=d?r:Qn(e,i[n]);return h}function ir(e,i,n){return e===e&&(n!==r&&(e=e<=n?e:n),i!==r&&(e=e>=i?e:i)),e}function et(e,i,n,c,h,d){var f,y=i&S,m=i&R,I=i&j;if(n&&(f=h?n(e,c,h,d):n(e)),f!==r)return f;if(!he(e))return e;var P=z(e);if(P){if(f=Zf(e),!y)return De(e,f)}else{var O=Oe(e),C=O==$i||O==Zo;if(Wt(e))return _c(e,y);if(O==Et||O==yr||C&&!h){if(f=m||C?{}:Lc(e),!y)return m?zf(e,hf(f,e)):kf(e,Ja(f,e))}else{if(!ie[O])return h?e:{};f=Xf(e,O,y)}}d||(d=new ut);var D=d.get(e);if(D)return D;d.set(e,f),fu(e)?e.forEach(function(L){f.add(et(L,i,n,L,e,d))}):pu(e)&&e.forEach(function(L,W){f.set(W,et(L,i,n,W,e,d))});var M=I?m?qn:Dn:m?je:_e,V=P?r:M(e);return Ye(V||e,function(L,W){V&&(W=L,L=e[W]),ri(f,W,et(L,i,n,W,e,d))}),f}function lf(e){var i=_e(e);return function(n){return Ya(n,e,i)}}function Ya(e,i,n){var c=n.length;if(e==null)return!c;for(e=re(e);c--;){var h=n[c],d=i[h],f=e[h];if(f===r&&!(h in e)||!d(f))return!1}return!0}function Za(e,i,n){if(typeof e!="function")throw new Ze(l);return ui(function(){e.apply(r,n)},i)}function ii(e,i,n,c){var h=-1,d=Di,f=!0,y=e.length,m=[],I=i.length;if(!y)return m;n&&(i=ce(i,Ve(n))),c?(d=en,f=!1):i.length>=a&&(d=Jr,f=!1,i=new rr(i));e:for(;++h<y;){var P=e[h],O=n==null?P:n(P);if(P=c||P!==0?P:0,f&&O===O){for(var C=I;C--;)if(i[C]===O)continue e;m.push(P)}else d(i,O,c)||m.push(P)}return m}var Ht=Sc(yt),Xa=Sc(vn,!0);function pf(e,i){var n=!0;return Ht(e,function(c,h,d){return n=!!i(c,h,d),n}),n}function Zi(e,i,n){for(var c=-1,h=e.length;++c<h;){var d=e[c],f=i(d);if(f!=null&&(y===r?f===f&&!Fe(f):n(f,y)))var y=f,m=d}return m}function df(e,i,n,c){var h=e.length;for(n=H(n),n<0&&(n=-n>h?0:h+n),c=c===r||c>h?h:H(c),c<0&&(c+=h),c=n>c?0:yu(c);n<c;)e[n++]=i;return e}function ec(e,i){var n=[];return Ht(e,function(c,h,d){i(c,h,d)&&n.push(c)}),n}function Ie(e,i,n,c,h){var d=-1,f=e.length;for(n||(n=tg),h||(h=[]);++d<f;){var y=e[d];i>0&&n(y)?i>1?Ie(y,i-1,n,c,h):Lt(h,y):c||(h[h.length]=y)}return h}var yn=Oc(),tc=Oc(!0);function yt(e,i){return e&&yn(e,i,_e)}function vn(e,i){return e&&tc(e,i,_e)}function Xi(e,i){return Mt(i,function(n){return $t(e[n])})}function sr(e,i){i=Kt(i,e);for(var n=0,c=i.length;e!=null&&n<c;)e=e[mt(i[n++])];return n&&n==c?e:r}function rc(e,i,n){var c=i(e);return z(e)?c:Lt(c,n(e))}function Ce(e){return e==null?e===r?zl:Ll:er&&er in re(e)?Qf(e):cg(e)}function mn(e,i){return e>i}function ff(e,i){return e!=null&&ee.call(e,i)}function gf(e,i){return e!=null&&i in re(e)}function yf(e,i,n){return e>=Se(i,n)&&e<we(i,n)}function wn(e,i,n){for(var c=n?en:Di,h=e[0].length,d=e.length,f=d,y=_(d),m=1/0,I=[];f--;){var P=e[f];f&&i&&(P=ce(P,Ve(i))),m=Se(P.length,m),y[f]=!n&&(i||h>=120&&P.length>=120)?new rr(f&&P):r}P=e[0];var O=-1,C=y[0];e:for(;++O<h&&I.length<m;){var D=P[O],M=i?i(D):D;if(D=n||D!==0?D:0,!(C?Jr(C,M):c(I,M,n))){for(f=d;--f;){var V=y[f];if(!(V?Jr(V,M):c(e[f],M,n)))continue e}C&&C.push(M),I.push(D)}}return I}function vf(e,i,n,c){return yt(e,function(h,d,f){i(c,n(h),d,f)}),c}function si(e,i,n){i=Kt(i,e),e=Vc(e,i);var c=e==null?e:e[mt(rt(i))];return c==null?r:He(c,e,n)}function ic(e){return le(e)&&Ce(e)==yr}function mf(e){return le(e)&&Ce(e)==Qr}function wf(e){return le(e)&&Ce(e)==Kr}function ni(e,i,n,c,h){return e===i?!0:e==null||i==null||!le(e)&&!le(i)?e!==e&&i!==i:_f(e,i,n,c,ni,h)}function _f(e,i,n,c,h,d){var f=z(e),y=z(i),m=f?Ri:Oe(e),I=y?Ri:Oe(i);m=m==yr?Et:m,I=I==yr?Et:I;var P=m==Et,O=I==Et,C=m==I;if(C&&Wt(e)){if(!Wt(i))return!1;f=!0,P=!1}if(C&&!P)return d||(d=new ut),f||Cr(e)?jc(e,i,n,c,h,d):Bf(e,i,m,n,c,h,d);if(!(n&x)){var D=P&&ee.call(e,"__wrapped__"),M=O&&ee.call(i,"__wrapped__");if(D||M){var V=D?e.value():e,L=M?i.value():i;return d||(d=new ut),h(V,L,n,c,d)}}return C?(d||(d=new ut),Gf(e,i,n,c,h,d)):!1}function bf(e){return le(e)&&Oe(e)==ot}function _n(e,i,n,c){var h=n.length,d=h,f=!c;if(e==null)return!d;for(e=re(e);h--;){var y=n[h];if(f&&y[2]?y[1]!==e[y[0]]:!(y[0]in e))return!1}for(;++h<d;){y=n[h];var m=y[0],I=e[m],P=y[1];if(f&&y[2]){if(I===r&&!(m in e))return!1}else{var O=new ut;if(c)var C=c(I,P,m,e,i,O);if(!(C===r?ni(P,I,x|K,c,O):C))return!1}}return!0}function sc(e){if(!he(e)||ig(e))return!1;var i=$t(e)?_d:hp;return i.test(or(e))}function Ef(e){return le(e)&&Ce(e)==Wr}function If(e){return le(e)&&Oe(e)==at}function Pf(e){return le(e)&&ys(e.length)&&!!oe[Ce(e)]}function nc(e){return typeof e=="function"?e:e==null?Ue:typeof e=="object"?z(e)?cc(e[0],e[1]):ac(e):Ru(e)}function bn(e){if(!ci(e))return Od(e);var i=[];for(var n in re(e))ee.call(e,n)&&n!="constructor"&&i.push(n);return i}function Sf(e){if(!he(e))return ag(e);var i=ci(e),n=[];for(var c in e)c=="constructor"&&(i||!ee.call(e,c))||n.push(c);return n}function En(e,i){return e<i}function oc(e,i){var n=-1,c=qe(e)?_(e.length):[];return Ht(e,function(h,d,f){c[++n]=i(h,d,f)}),c}function ac(e){var i=Un(e);return i.length==1&&i[0][2]?zc(i[0][0],i[0][1]):function(n){return n===e||_n(n,e,i)}}function cc(e,i){return Ln(e)&&kc(i)?zc(mt(e),i):function(n){var c=Qn(n,e);return c===r&&c===i?Jn(n,e):ni(i,c,x|K)}}function es(e,i,n,c,h){e!==i&&yn(i,function(d,f){if(h||(h=new ut),he(d))Of(e,i,f,n,es,c,h);else{var y=c?c(zn(e,f),d,f+"",e,i,h):r;y===r&&(y=d),fn(e,f,y)}},je)}function Of(e,i,n,c,h,d,f){var y=zn(e,n),m=zn(i,n),I=f.get(m);if(I){fn(e,n,I);return}var P=d?d(y,m,n+"",e,i,f):r,O=P===r;if(O){var C=z(m),D=!C&&Wt(m),M=!C&&!D&&Cr(m);P=m,C||D||M?z(y)?P=y:fe(y)?P=De(y):D?(O=!1,P=_c(m,!0)):M?(O=!1,P=bc(m,!0)):P=[]:hi(m)||ar(m)?(P=y,ar(y)?P=vu(y):(!he(y)||$t(y))&&(P=Lc(m))):O=!1}O&&(f.set(m,P),h(P,m,c,d,f),f.delete(m)),fn(e,n,P)}function uc(e,i){var n=e.length;if(n)return i+=i<0?n:0,Nt(i,n)?e[i]:r}function hc(e,i,n){i.length?i=ce(i,function(d){return z(d)?function(f){return sr(f,d.length===1?d[0]:d)}:d}):i=[Ue];var c=-1;i=ce(i,Ve(U()));var h=oc(e,function(d,f,y){var m=ce(i,function(I){return I(d)});return{criteria:m,index:++c,value:d}});return Zp(h,function(d,f){return Lf(d,f,n)})}function Rf(e,i){return lc(e,i,function(n,c){return Jn(e,c)})}function lc(e,i,n){for(var c=-1,h=i.length,d={};++c<h;){var f=i[c],y=sr(e,f);n(y,f)&&oi(d,Kt(f,e),y)}return d}function Nf(e){return function(i){return sr(i,e)}}function In(e,i,n,c){var h=c?Yp:wr,d=-1,f=i.length,y=e;for(e===i&&(i=De(i)),n&&(y=ce(e,Ve(n)));++d<f;)for(var m=0,I=i[d],P=n?n(I):I;(m=h(y,P,m,c))>-1;)y!==e&&Ki.call(y,m,1),Ki.call(e,m,1);return e}function pc(e,i){for(var n=e?i.length:0,c=n-1;n--;){var h=i[n];if(n==c||h!==d){var d=h;Nt(h)?Ki.call(e,h,1):Rn(e,h)}}return e}function Pn(e,i){return e+Bi(Wa()*(i-e+1))}function $f(e,i,n,c){for(var h=-1,d=we(Wi((i-e)/(n||1)),0),f=_(d);d--;)f[c?d:++h]=e,e+=n;return f}function Sn(e,i){var n="";if(!e||i<1||i>Ut)return n;do i%2&&(n+=e),i=Bi(i/2),i&&(e+=e);while(i);return n}function F(e,i){return Hn(Hc(e,i,Ue),e+"")}function Cf(e){return Qa(Tr(e))}function Tf(e,i){var n=Tr(e);return hs(n,ir(i,0,n.length))}function oi(e,i,n,c){if(!he(e))return e;i=Kt(i,e);for(var h=-1,d=i.length,f=d-1,y=e;y!=null&&++h<d;){var m=mt(i[h]),I=n;if(m==="__proto__"||m==="constructor"||m==="prototype")return e;if(h!=f){var P=y[m];I=c?c(P,m,y):r,I===r&&(I=he(P)?P:Nt(i[h+1])?[]:{})}ri(y,m,I),y=y[m]}return e}var dc=Gi?function(e,i){return Gi.set(e,i),e}:Ue,xf=Fi?function(e,i){return Fi(e,"toString",{configurable:!0,enumerable:!1,value:Zn(i),writable:!0})}:Ue;function Af(e){return hs(Tr(e))}function tt(e,i,n){var c=-1,h=e.length;i<0&&(i=-i>h?0:h+i),n=n>h?h:n,n<0&&(n+=h),h=i>n?0:n-i>>>0,i>>>=0;for(var d=_(h);++c<h;)d[c]=e[c+i];return d}function Df(e,i){var n;return Ht(e,function(c,h,d){return n=i(c,h,d),!n}),!!n}function ts(e,i,n){var c=0,h=e==null?c:e.length;if(typeof i=="number"&&i===i&&h<=ql){for(;c<h;){var d=c+h>>>1,f=e[d];f!==null&&!Fe(f)&&(n?f<=i:f<i)?c=d+1:h=d}return h}return On(e,i,Ue,n)}function On(e,i,n,c){var h=0,d=e==null?0:e.length;if(d===0)return 0;i=n(i);for(var f=i!==i,y=i===null,m=Fe(i),I=i===r;h<d;){var P=Bi((h+d)/2),O=n(e[P]),C=O!==r,D=O===null,M=O===O,V=Fe(O);if(f)var L=c||M;else I?L=M&&(c||C):y?L=M&&C&&(c||!D):m?L=M&&C&&!D&&(c||!V):D||V?L=!1:L=c?O<=i:O<i;L?h=P+1:d=P}return Se(d,Dl)}function fc(e,i){for(var n=-1,c=e.length,h=0,d=[];++n<c;){var f=e[n],y=i?i(f):f;if(!n||!ht(y,m)){var m=y;d[h++]=f===0?0:f}}return d}function gc(e){return typeof e=="number"?e:Fe(e)?Oi:+e}function Ke(e){if(typeof e=="string")return e;if(z(e))return ce(e,Ke)+"";if(Fe(e))return Ba?Ba.call(e):"";var i=e+"";return i=="0"&&1/e==-Zt?"-0":i}function Vt(e,i,n){var c=-1,h=Di,d=e.length,f=!0,y=[],m=y;if(n)f=!1,h=en;else if(d>=a){var I=i?null:Ff(e);if(I)return ji(I);f=!1,h=Jr,m=new rr}else m=i?[]:y;e:for(;++c<d;){var P=e[c],O=i?i(P):P;if(P=n||P!==0?P:0,f&&O===O){for(var C=m.length;C--;)if(m[C]===O)continue e;i&&m.push(O),y.push(P)}else h(m,O,n)||(m!==y&&m.push(O),y.push(P))}return y}function Rn(e,i){return i=Kt(i,e),e=Vc(e,i),e==null||delete e[mt(rt(i))]}function yc(e,i,n,c){return oi(e,i,n(sr(e,i)),c)}function rs(e,i,n,c){for(var h=e.length,d=c?h:-1;(c?d--:++d<h)&&i(e[d],d,e););return n?tt(e,c?0:d,c?d+1:h):tt(e,c?d+1:0,c?h:d)}function vc(e,i){var n=e;return n instanceof G&&(n=n.value()),tn(i,function(c,h){return h.func.apply(h.thisArg,Lt([c],h.args))},n)}function Nn(e,i,n){var c=e.length;if(c<2)return c?Vt(e[0]):[];for(var h=-1,d=_(c);++h<c;)for(var f=e[h],y=-1;++y<c;)y!=h&&(d[h]=ii(d[h]||f,e[y],i,n));return Vt(Ie(d,1),i,n)}function mc(e,i,n){for(var c=-1,h=e.length,d=i.length,f={};++c<h;){var y=c<d?i[c]:r;n(f,e[c],y)}return f}function $n(e){return fe(e)?e:[]}function Cn(e){return typeof e=="function"?e:Ue}function Kt(e,i){return z(e)?e:Ln(e,i)?[e]:Bc(X(e))}var qf=F;function Ft(e,i,n){var c=e.length;return n=n===r?c:n,!i&&n>=c?e:tt(e,i,n)}var wc=bd||function(e){return Ee.clearTimeout(e)};function _c(e,i){if(i)return e.slice();var n=e.length,c=za?za(n):new e.constructor(n);return e.copy(c),c}function Tn(e){var i=new e.constructor(e.byteLength);return new Hi(i).set(new Hi(e)),i}function jf(e,i){var n=i?Tn(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function Uf(e){var i=new e.constructor(e.source,ia.exec(e));return i.lastIndex=e.lastIndex,i}function Mf(e){return ti?re(ti.call(e)):{}}function bc(e,i){var n=i?Tn(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ec(e,i){if(e!==i){var n=e!==r,c=e===null,h=e===e,d=Fe(e),f=i!==r,y=i===null,m=i===i,I=Fe(i);if(!y&&!I&&!d&&e>i||d&&f&&m&&!y&&!I||c&&f&&m||!n&&m||!h)return 1;if(!c&&!d&&!I&&e<i||I&&n&&h&&!c&&!d||y&&n&&h||!f&&h||!m)return-1}return 0}function Lf(e,i,n){for(var c=-1,h=e.criteria,d=i.criteria,f=h.length,y=n.length;++c<f;){var m=Ec(h[c],d[c]);if(m){if(c>=y)return m;var I=n[c];return m*(I=="desc"?-1:1)}}return e.index-i.index}function Ic(e,i,n,c){for(var h=-1,d=e.length,f=n.length,y=-1,m=i.length,I=we(d-f,0),P=_(m+I),O=!c;++y<m;)P[y]=i[y];for(;++h<f;)(O||h<d)&&(P[n[h]]=e[h]);for(;I--;)P[y++]=e[h++];return P}function Pc(e,i,n,c){for(var h=-1,d=e.length,f=-1,y=n.length,m=-1,I=i.length,P=we(d-y,0),O=_(P+I),C=!c;++h<P;)O[h]=e[h];for(var D=h;++m<I;)O[D+m]=i[m];for(;++f<y;)(C||h<d)&&(O[D+n[f]]=e[h++]);return O}function De(e,i){var n=-1,c=e.length;for(i||(i=_(c));++n<c;)i[n]=e[n];return i}function vt(e,i,n,c){var h=!n;n||(n={});for(var d=-1,f=i.length;++d<f;){var y=i[d],m=c?c(n[y],e[y],y,n,e):r;m===r&&(m=e[y]),h?St(n,y,m):ri(n,y,m)}return n}function kf(e,i){return vt(e,Mn(e),i)}function zf(e,i){return vt(e,Uc(e),i)}function is(e,i){return function(n,c){var h=z(n)?Fp:uf,d=i?i():{};return h(n,e,U(c,2),d)}}function Rr(e){return F(function(i,n){var c=-1,h=n.length,d=h>1?n[h-1]:r,f=h>2?n[2]:r;for(d=e.length>3&&typeof d=="function"?(h--,d):r,f&&Te(n[0],n[1],f)&&(d=h<3?r:d,h=1),i=re(i);++c<h;){var y=n[c];y&&e(i,y,c,d)}return i})}function Sc(e,i){return function(n,c){if(n==null)return n;if(!qe(n))return e(n,c);for(var h=n.length,d=i?h:-1,f=re(n);(i?d--:++d<h)&&c(f[d],d,f)!==!1;);return n}}function Oc(e){return function(i,n,c){for(var h=-1,d=re(i),f=c(i),y=f.length;y--;){var m=f[e?y:++h];if(n(d[m],m,d)===!1)break}return i}}function Hf(e,i,n){var c=i&A,h=ai(e);function d(){var f=this&&this!==Ee&&this instanceof d?h:e;return f.apply(c?n:this,arguments)}return d}function Rc(e){return function(i){i=X(i);var n=_r(i)?ct(i):r,c=n?n[0]:i.charAt(0),h=n?Ft(n,1).join(""):i.slice(1);return c[e]()+h}}function Nr(e){return function(i){return tn(Su(Pu(i).replace(Tp,"")),e,"")}}function ai(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var n=Or(e.prototype),c=e.apply(n,i);return he(c)?c:n}}function Vf(e,i,n){var c=ai(e);function h(){for(var d=arguments.length,f=_(d),y=d,m=$r(h);y--;)f[y]=arguments[y];var I=d<3&&f[0]!==m&&f[d-1]!==m?[]:kt(f,m);if(d-=I.length,d<n)return xc(e,i,ss,h.placeholder,r,f,I,r,r,n-d);var P=this&&this!==Ee&&this instanceof h?c:e;return He(P,this,f)}return h}function Nc(e){return function(i,n,c){var h=re(i);if(!qe(i)){var d=U(n,3);i=_e(i),n=function(y){return d(h[y],y,h)}}var f=e(i,n,c);return f>-1?h[d?i[f]:f]:r}}function $c(e){return Rt(function(i){var n=i.length,c=n,h=Xe.prototype.thru;for(e&&i.reverse();c--;){var d=i[c];if(typeof d!="function")throw new Ze(l);if(h&&!f&&cs(d)=="wrapper")var f=new Xe([],!0)}for(c=f?c:n;++c<n;){d=i[c];var y=cs(d),m=y=="wrapper"?jn(d):r;m&&kn(m[0])&&m[1]==(de|J|ae|$e)&&!m[4].length&&m[9]==1?f=f[cs(m[0])].apply(f,m[3]):f=d.length==1&&kn(d)?f[y]():f.thru(d)}return function(){var I=arguments,P=I[0];if(f&&I.length==1&&z(P))return f.plant(P).value();for(var O=0,C=n?i[O].apply(this,I):P;++O<n;)C=i[O].call(this,C);return C}})}function ss(e,i,n,c,h,d,f,y,m,I){var P=i&de,O=i&A,C=i&B,D=i&(J|Y),M=i&jt,V=C?r:ai(e);function L(){for(var W=arguments.length,Q=_(W),We=W;We--;)Q[We]=arguments[We];if(D)var xe=$r(L),Be=ed(Q,xe);if(c&&(Q=Ic(Q,c,h,D)),d&&(Q=Pc(Q,d,f,D)),W-=Be,D&&W<I){var ge=kt(Q,xe);return xc(e,i,ss,L.placeholder,n,Q,ge,y,m,I-W)}var lt=O?n:this,Tt=C?lt[e]:e;return W=Q.length,y?Q=ug(Q,y):M&&W>1&&Q.reverse(),P&&m<W&&(Q.length=m),this&&this!==Ee&&this instanceof L&&(Tt=V||ai(Tt)),Tt.apply(lt,Q)}return L}function Cc(e,i){return function(n,c){return vf(n,e,i(c),{})}}function ns(e,i){return function(n,c){var h;if(n===r&&c===r)return i;if(n!==r&&(h=n),c!==r){if(h===r)return c;typeof n=="string"||typeof c=="string"?(n=Ke(n),c=Ke(c)):(n=gc(n),c=gc(c)),h=e(n,c)}return h}}function xn(e){return Rt(function(i){return i=ce(i,Ve(U())),F(function(n){var c=this;return e(i,function(h){return He(h,c,n)})})})}function os(e,i){i=i===r?" ":Ke(i);var n=i.length;if(n<2)return n?Sn(i,e):i;var c=Sn(i,Wi(e/br(i)));return _r(i)?Ft(ct(c),0,e).join(""):c.slice(0,e)}function Kf(e,i,n,c){var h=i&A,d=ai(e);function f(){for(var y=-1,m=arguments.length,I=-1,P=c.length,O=_(P+m),C=this&&this!==Ee&&this instanceof f?d:e;++I<P;)O[I]=c[I];for(;m--;)O[I++]=arguments[++y];return He(C,h?n:this,O)}return f}function Tc(e){return function(i,n,c){return c&&typeof c!="number"&&Te(i,n,c)&&(n=c=r),i=Ct(i),n===r?(n=i,i=0):n=Ct(n),c=c===r?i<n?1:-1:Ct(c),$f(i,n,c,e)}}function as(e){return function(i,n){return typeof i=="string"&&typeof n=="string"||(i=it(i),n=it(n)),e(i,n)}}function xc(e,i,n,c,h,d,f,y,m,I){var P=i&J,O=P?f:r,C=P?r:f,D=P?d:r,M=P?r:d;i|=P?ae:Ne,i&=~(P?Ne:ae),i&pe||(i&=~(A|B));var V=[e,i,h,D,O,M,C,y,m,I],L=n.apply(r,V);return kn(e)&&Kc(L,V),L.placeholder=c,Fc(L,e,i)}function An(e){var i=me[e];return function(n,c){if(n=it(n),c=c==null?0:Se(H(c),292),c&&Fa(n)){var h=(X(n)+"e").split("e"),d=i(h[0]+"e"+(+h[1]+c));return h=(X(d)+"e").split("e"),+(h[0]+"e"+(+h[1]-c))}return i(n)}}var Ff=Pr&&1/ji(new Pr([,-0]))[1]==Zt?function(e){return new Pr(e)}:to;function Ac(e){return function(i){var n=Oe(i);return n==ot?un(i):n==at?ad(i):Xp(i,e(i))}}function Ot(e,i,n,c,h,d,f,y){var m=i&B;if(!m&&typeof e!="function")throw new Ze(l);var I=c?c.length:0;if(I||(i&=~(ae|Ne),c=h=r),f=f===r?f:we(H(f),0),y=y===r?y:H(y),I-=h?h.length:0,i&Ne){var P=c,O=h;c=h=r}var C=m?r:jn(e),D=[e,i,n,c,h,P,O,d,f,y];if(C&&og(D,C),e=D[0],i=D[1],n=D[2],c=D[3],h=D[4],y=D[9]=D[9]===r?m?0:e.length:we(D[9]-I,0),!y&&i&(J|Y)&&(i&=~(J|Y)),!i||i==A)var M=Hf(e,i,n);else i==J||i==Y?M=Vf(e,i,y):(i==ae||i==(A|ae))&&!h.length?M=Kf(e,i,n,c):M=ss.apply(r,D);var V=C?dc:Kc;return Fc(V(M,D),e,i)}function Dc(e,i,n,c){return e===r||ht(e,Ir[n])&&!ee.call(c,n)?i:e}function qc(e,i,n,c,h,d){return he(e)&&he(i)&&(d.set(i,e),es(e,i,r,qc,d),d.delete(i)),e}function Wf(e){return hi(e)?r:e}function jc(e,i,n,c,h,d){var f=n&x,y=e.length,m=i.length;if(y!=m&&!(f&&m>y))return!1;var I=d.get(e),P=d.get(i);if(I&&P)return I==i&&P==e;var O=-1,C=!0,D=n&K?new rr:r;for(d.set(e,i),d.set(i,e);++O<y;){var M=e[O],V=i[O];if(c)var L=f?c(V,M,O,i,e,d):c(M,V,O,e,i,d);if(L!==r){if(L)continue;C=!1;break}if(D){if(!rn(i,function(W,Q){if(!Jr(D,Q)&&(M===W||h(M,W,n,c,d)))return D.push(Q)})){C=!1;break}}else if(!(M===V||h(M,V,n,c,d))){C=!1;break}}return d.delete(e),d.delete(i),C}function Bf(e,i,n,c,h,d,f){switch(n){case vr:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Qr:return!(e.byteLength!=i.byteLength||!d(new Hi(e),new Hi(i)));case Vr:case Kr:case Fr:return ht(+e,+i);case Ni:return e.name==i.name&&e.message==i.message;case Wr:case Br:return e==i+"";case ot:var y=un;case at:var m=c&x;if(y||(y=ji),e.size!=i.size&&!m)return!1;var I=f.get(e);if(I)return I==i;c|=K,f.set(e,i);var P=jc(y(e),y(i),c,h,d,f);return f.delete(e),P;case Ci:if(ti)return ti.call(e)==ti.call(i)}return!1}function Gf(e,i,n,c,h,d){var f=n&x,y=Dn(e),m=y.length,I=Dn(i),P=I.length;if(m!=P&&!f)return!1;for(var O=m;O--;){var C=y[O];if(!(f?C in i:ee.call(i,C)))return!1}var D=d.get(e),M=d.get(i);if(D&&M)return D==i&&M==e;var V=!0;d.set(e,i),d.set(i,e);for(var L=f;++O<m;){C=y[O];var W=e[C],Q=i[C];if(c)var We=f?c(Q,W,C,i,e,d):c(W,Q,C,e,i,d);if(!(We===r?W===Q||h(W,Q,n,c,d):We)){V=!1;break}L||(L=C=="constructor")}if(V&&!L){var xe=e.constructor,Be=i.constructor;xe!=Be&&"constructor"in e&&"constructor"in i&&!(typeof xe=="function"&&xe instanceof xe&&typeof Be=="function"&&Be instanceof Be)&&(V=!1)}return d.delete(e),d.delete(i),V}function Rt(e){return Hn(Hc(e,r,Yc),e+"")}function Dn(e){return rc(e,_e,Mn)}function qn(e){return rc(e,je,Uc)}var jn=Gi?function(e){return Gi.get(e)}:to;function cs(e){for(var i=e.name+"",n=Sr[i],c=ee.call(Sr,i)?n.length:0;c--;){var h=n[c],d=h.func;if(d==null||d==e)return h.name}return i}function $r(e){var i=ee.call(p,"placeholder")?p:e;return i.placeholder}function U(){var e=p.iteratee||Xn;return e=e===Xn?nc:e,arguments.length?e(arguments[0],arguments[1]):e}function us(e,i){var n=e.__data__;return rg(i)?n[typeof i=="string"?"string":"hash"]:n.map}function Un(e){for(var i=_e(e),n=i.length;n--;){var c=i[n],h=e[c];i[n]=[c,h,kc(h)]}return i}function nr(e,i){var n=sd(e,i);return sc(n)?n:r}function Qf(e){var i=ee.call(e,er),n=e[er];try{e[er]=r;var c=!0}catch{}var h=ki.call(e);return c&&(i?e[er]=n:delete e[er]),h}var Mn=ln?function(e){return e==null?[]:(e=re(e),Mt(ln(e),function(i){return Va.call(e,i)}))}:ro,Uc=ln?function(e){for(var i=[];e;)Lt(i,Mn(e)),e=Vi(e);return i}:ro,Oe=Ce;(pn&&Oe(new pn(new ArrayBuffer(1)))!=vr||Zr&&Oe(new Zr)!=ot||dn&&Oe(dn.resolve())!=Xo||Pr&&Oe(new Pr)!=at||Xr&&Oe(new Xr)!=Gr)&&(Oe=function(e){var i=Ce(e),n=i==Et?e.constructor:r,c=n?or(n):"";if(c)switch(c){case Cd:return vr;case Td:return ot;case xd:return Xo;case Ad:return at;case Dd:return Gr}return i});function Jf(e,i,n){for(var c=-1,h=n.length;++c<h;){var d=n[c],f=d.size;switch(d.type){case"drop":e+=f;break;case"dropRight":i-=f;break;case"take":i=Se(i,e+f);break;case"takeRight":e=we(e,i-f);break}}return{start:e,end:i}}function Yf(e){var i=e.match(rp);return i?i[1].split(ip):[]}function Mc(e,i,n){i=Kt(i,e);for(var c=-1,h=i.length,d=!1;++c<h;){var f=mt(i[c]);if(!(d=e!=null&&n(e,f)))break;e=e[f]}return d||++c!=h?d:(h=e==null?0:e.length,!!h&&ys(h)&&Nt(f,h)&&(z(e)||ar(e)))}function Zf(e){var i=e.length,n=new e.constructor(i);return i&&typeof e[0]=="string"&&ee.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Lc(e){return typeof e.constructor=="function"&&!ci(e)?Or(Vi(e)):{}}function Xf(e,i,n){var c=e.constructor;switch(i){case Qr:return Tn(e);case Vr:case Kr:return new c(+e);case vr:return jf(e,n);case js:case Us:case Ms:case Ls:case ks:case zs:case Hs:case Vs:case Ks:return bc(e,n);case ot:return new c;case Fr:case Br:return new c(e);case Wr:return Uf(e);case at:return new c;case Ci:return Mf(e)}}function eg(e,i){var n=i.length;if(!n)return e;var c=n-1;return i[c]=(n>1?"& ":"")+i[c],i=i.join(n>2?", ":" "),e.replace(tp,`{
/* [wrapped with `+i+`] */
`)}function tg(e){return z(e)||ar(e)||!!(Ka&&e&&e[Ka])}function Nt(e,i){var n=typeof e;return i=i??Ut,!!i&&(n=="number"||n!="symbol"&&pp.test(e))&&e>-1&&e%1==0&&e<i}function Te(e,i,n){if(!he(n))return!1;var c=typeof i;return(c=="number"?qe(n)&&Nt(i,n.length):c=="string"&&i in n)?ht(n[i],e):!1}function Ln(e,i){if(z(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Fe(e)?!0:Yl.test(e)||!Jl.test(e)||i!=null&&e in re(i)}function rg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function kn(e){var i=cs(e),n=p[i];if(typeof n!="function"||!(i in G.prototype))return!1;if(e===n)return!0;var c=jn(n);return!!c&&e===c[0]}function ig(e){return!!ka&&ka in e}var sg=Mi?$t:io;function ci(e){var i=e&&e.constructor,n=typeof i=="function"&&i.prototype||Ir;return e===n}function kc(e){return e===e&&!he(e)}function zc(e,i){return function(n){return n==null?!1:n[e]===i&&(i!==r||e in re(n))}}function ng(e){var i=fs(e,function(c){return n.size===b&&n.clear(),c}),n=i.cache;return i}function og(e,i){var n=e[1],c=i[1],h=n|c,d=h<(A|B|de),f=c==de&&n==J||c==de&&n==$e&&e[7].length<=i[8]||c==(de|$e)&&i[7].length<=i[8]&&n==J;if(!(d||f))return e;c&A&&(e[2]=i[2],h|=n&A?0:pe);var y=i[3];if(y){var m=e[3];e[3]=m?Ic(m,y,i[4]):y,e[4]=m?kt(e[3],N):i[4]}return y=i[5],y&&(m=e[5],e[5]=m?Pc(m,y,i[6]):y,e[6]=m?kt(e[5],N):i[6]),y=i[7],y&&(e[7]=y),c&de&&(e[8]=e[8]==null?i[8]:Se(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=h,e}function ag(e){var i=[];if(e!=null)for(var n in re(e))i.push(n);return i}function cg(e){return ki.call(e)}function Hc(e,i,n){return i=we(i===r?e.length-1:i,0),function(){for(var c=arguments,h=-1,d=we(c.length-i,0),f=_(d);++h<d;)f[h]=c[i+h];h=-1;for(var y=_(i+1);++h<i;)y[h]=c[h];return y[i]=n(f),He(e,this,y)}}function Vc(e,i){return i.length<2?e:sr(e,tt(i,0,-1))}function ug(e,i){for(var n=e.length,c=Se(i.length,n),h=De(e);c--;){var d=i[c];e[c]=Nt(d,n)?h[d]:r}return e}function zn(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Kc=Wc(dc),ui=Id||function(e,i){return Ee.setTimeout(e,i)},Hn=Wc(xf);function Fc(e,i,n){var c=i+"";return Hn(e,eg(c,hg(Yf(c),n)))}function Wc(e){var i=0,n=0;return function(){var c=Rd(),h=Cl-(c-n);if(n=c,h>0){if(++i>=$l)return arguments[0]}else i=0;return e.apply(r,arguments)}}function hs(e,i){var n=-1,c=e.length,h=c-1;for(i=i===r?c:i;++n<i;){var d=Pn(n,h),f=e[d];e[d]=e[n],e[n]=f}return e.length=i,e}var Bc=ng(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Zl,function(n,c,h,d){i.push(h?d.replace(op,"$1"):c||n)}),i});function mt(e){if(typeof e=="string"||Fe(e))return e;var i=e+"";return i=="0"&&1/e==-Zt?"-0":i}function or(e){if(e!=null){try{return Li.call(e)}catch{}try{return e+""}catch{}}return""}function hg(e,i){return Ye(jl,function(n){var c="_."+n[0];i&n[1]&&!Di(e,c)&&e.push(c)}),e.sort()}function Gc(e){if(e instanceof G)return e.clone();var i=new Xe(e.__wrapped__,e.__chain__);return i.__actions__=De(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function lg(e,i,n){(n?Te(e,i,n):i===r)?i=1:i=we(H(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var h=0,d=0,f=_(Wi(c/i));h<c;)f[d++]=tt(e,h,h+=i);return f}function pg(e){for(var i=-1,n=e==null?0:e.length,c=0,h=[];++i<n;){var d=e[i];d&&(h[c++]=d)}return h}function dg(){var e=arguments.length;if(!e)return[];for(var i=_(e-1),n=arguments[0],c=e;c--;)i[c-1]=arguments[c];return Lt(z(n)?De(n):[n],Ie(i,1))}var fg=F(function(e,i){return fe(e)?ii(e,Ie(i,1,fe,!0)):[]}),gg=F(function(e,i){var n=rt(i);return fe(n)&&(n=r),fe(e)?ii(e,Ie(i,1,fe,!0),U(n,2)):[]}),yg=F(function(e,i){var n=rt(i);return fe(n)&&(n=r),fe(e)?ii(e,Ie(i,1,fe,!0),r,n):[]});function vg(e,i,n){var c=e==null?0:e.length;return c?(i=n||i===r?1:H(i),tt(e,i<0?0:i,c)):[]}function mg(e,i,n){var c=e==null?0:e.length;return c?(i=n||i===r?1:H(i),i=c-i,tt(e,0,i<0?0:i)):[]}function wg(e,i){return e&&e.length?rs(e,U(i,3),!0,!0):[]}function _g(e,i){return e&&e.length?rs(e,U(i,3),!0):[]}function bg(e,i,n,c){var h=e==null?0:e.length;return h?(n&&typeof n!="number"&&Te(e,i,n)&&(n=0,c=h),df(e,i,n,c)):[]}function Qc(e,i,n){var c=e==null?0:e.length;if(!c)return-1;var h=n==null?0:H(n);return h<0&&(h=we(c+h,0)),qi(e,U(i,3),h)}function Jc(e,i,n){var c=e==null?0:e.length;if(!c)return-1;var h=c-1;return n!==r&&(h=H(n),h=n<0?we(c+h,0):Se(h,c-1)),qi(e,U(i,3),h,!0)}function Yc(e){var i=e==null?0:e.length;return i?Ie(e,1):[]}function Eg(e){var i=e==null?0:e.length;return i?Ie(e,Zt):[]}function Ig(e,i){var n=e==null?0:e.length;return n?(i=i===r?1:H(i),Ie(e,i)):[]}function Pg(e){for(var i=-1,n=e==null?0:e.length,c={};++i<n;){var h=e[i];c[h[0]]=h[1]}return c}function Zc(e){return e&&e.length?e[0]:r}function Sg(e,i,n){var c=e==null?0:e.length;if(!c)return-1;var h=n==null?0:H(n);return h<0&&(h=we(c+h,0)),wr(e,i,h)}function Og(e){var i=e==null?0:e.length;return i?tt(e,0,-1):[]}var Rg=F(function(e){var i=ce(e,$n);return i.length&&i[0]===e[0]?wn(i):[]}),Ng=F(function(e){var i=rt(e),n=ce(e,$n);return i===rt(n)?i=r:n.pop(),n.length&&n[0]===e[0]?wn(n,U(i,2)):[]}),$g=F(function(e){var i=rt(e),n=ce(e,$n);return i=typeof i=="function"?i:r,i&&n.pop(),n.length&&n[0]===e[0]?wn(n,r,i):[]});function Cg(e,i){return e==null?"":Sd.call(e,i)}function rt(e){var i=e==null?0:e.length;return i?e[i-1]:r}function Tg(e,i,n){var c=e==null?0:e.length;if(!c)return-1;var h=c;return n!==r&&(h=H(n),h=h<0?we(c+h,0):Se(h,c-1)),i===i?ud(e,i,h):qi(e,xa,h,!0)}function xg(e,i){return e&&e.length?uc(e,H(i)):r}var Ag=F(Xc);function Xc(e,i){return e&&e.length&&i&&i.length?In(e,i):e}function Dg(e,i,n){return e&&e.length&&i&&i.length?In(e,i,U(n,2)):e}function qg(e,i,n){return e&&e.length&&i&&i.length?In(e,i,r,n):e}var jg=Rt(function(e,i){var n=e==null?0:e.length,c=gn(e,i);return pc(e,ce(i,function(h){return Nt(h,n)?+h:h}).sort(Ec)),c});function Ug(e,i){var n=[];if(!(e&&e.length))return n;var c=-1,h=[],d=e.length;for(i=U(i,3);++c<d;){var f=e[c];i(f,c,e)&&(n.push(f),h.push(c))}return pc(e,h),n}function Vn(e){return e==null?e:$d.call(e)}function Mg(e,i,n){var c=e==null?0:e.length;return c?(n&&typeof n!="number"&&Te(e,i,n)?(i=0,n=c):(i=i==null?0:H(i),n=n===r?c:H(n)),tt(e,i,n)):[]}function Lg(e,i){return ts(e,i)}function kg(e,i,n){return On(e,i,U(n,2))}function zg(e,i){var n=e==null?0:e.length;if(n){var c=ts(e,i);if(c<n&&ht(e[c],i))return c}return-1}function Hg(e,i){return ts(e,i,!0)}function Vg(e,i,n){return On(e,i,U(n,2),!0)}function Kg(e,i){var n=e==null?0:e.length;if(n){var c=ts(e,i,!0)-1;if(ht(e[c],i))return c}return-1}function Fg(e){return e&&e.length?fc(e):[]}function Wg(e,i){return e&&e.length?fc(e,U(i,2)):[]}function Bg(e){var i=e==null?0:e.length;return i?tt(e,1,i):[]}function Gg(e,i,n){return e&&e.length?(i=n||i===r?1:H(i),tt(e,0,i<0?0:i)):[]}function Qg(e,i,n){var c=e==null?0:e.length;return c?(i=n||i===r?1:H(i),i=c-i,tt(e,i<0?0:i,c)):[]}function Jg(e,i){return e&&e.length?rs(e,U(i,3),!1,!0):[]}function Yg(e,i){return e&&e.length?rs(e,U(i,3)):[]}var Zg=F(function(e){return Vt(Ie(e,1,fe,!0))}),Xg=F(function(e){var i=rt(e);return fe(i)&&(i=r),Vt(Ie(e,1,fe,!0),U(i,2))}),ey=F(function(e){var i=rt(e);return i=typeof i=="function"?i:r,Vt(Ie(e,1,fe,!0),r,i)});function ty(e){return e&&e.length?Vt(e):[]}function ry(e,i){return e&&e.length?Vt(e,U(i,2)):[]}function iy(e,i){return i=typeof i=="function"?i:r,e&&e.length?Vt(e,r,i):[]}function Kn(e){if(!(e&&e.length))return[];var i=0;return e=Mt(e,function(n){if(fe(n))return i=we(n.length,i),!0}),an(i,function(n){return ce(e,sn(n))})}function eu(e,i){if(!(e&&e.length))return[];var n=Kn(e);return i==null?n:ce(n,function(c){return He(i,r,c)})}var sy=F(function(e,i){return fe(e)?ii(e,i):[]}),ny=F(function(e){return Nn(Mt(e,fe))}),oy=F(function(e){var i=rt(e);return fe(i)&&(i=r),Nn(Mt(e,fe),U(i,2))}),ay=F(function(e){var i=rt(e);return i=typeof i=="function"?i:r,Nn(Mt(e,fe),r,i)}),cy=F(Kn);function uy(e,i){return mc(e||[],i||[],ri)}function hy(e,i){return mc(e||[],i||[],oi)}var ly=F(function(e){var i=e.length,n=i>1?e[i-1]:r;return n=typeof n=="function"?(e.pop(),n):r,eu(e,n)});function tu(e){var i=p(e);return i.__chain__=!0,i}function py(e,i){return i(e),e}function ls(e,i){return i(e)}var dy=Rt(function(e){var i=e.length,n=i?e[0]:0,c=this.__wrapped__,h=function(d){return gn(d,e)};return i>1||this.__actions__.length||!(c instanceof G)||!Nt(n)?this.thru(h):(c=c.slice(n,+n+(i?1:0)),c.__actions__.push({func:ls,args:[h],thisArg:r}),new Xe(c,this.__chain__).thru(function(d){return i&&!d.length&&d.push(r),d}))});function fy(){return tu(this)}function gy(){return new Xe(this.value(),this.__chain__)}function yy(){this.__values__===r&&(this.__values__=gu(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function vy(){return this}function my(e){for(var i,n=this;n instanceof Ji;){var c=Gc(n);c.__index__=0,c.__values__=r,i?h.__wrapped__=c:i=c;var h=c;n=n.__wrapped__}return h.__wrapped__=e,i}function wy(){var e=this.__wrapped__;if(e instanceof G){var i=e;return this.__actions__.length&&(i=new G(this)),i=i.reverse(),i.__actions__.push({func:ls,args:[Vn],thisArg:r}),new Xe(i,this.__chain__)}return this.thru(Vn)}function _y(){return vc(this.__wrapped__,this.__actions__)}var by=is(function(e,i,n){ee.call(e,n)?++e[n]:St(e,n,1)});function Ey(e,i,n){var c=z(e)?Ca:pf;return n&&Te(e,i,n)&&(i=r),c(e,U(i,3))}function Iy(e,i){var n=z(e)?Mt:ec;return n(e,U(i,3))}var Py=Nc(Qc),Sy=Nc(Jc);function Oy(e,i){return Ie(ps(e,i),1)}function Ry(e,i){return Ie(ps(e,i),Zt)}function Ny(e,i,n){return n=n===r?1:H(n),Ie(ps(e,i),n)}function ru(e,i){var n=z(e)?Ye:Ht;return n(e,U(i,3))}function iu(e,i){var n=z(e)?Wp:Xa;return n(e,U(i,3))}var $y=is(function(e,i,n){ee.call(e,n)?e[n].push(i):St(e,n,[i])});function Cy(e,i,n,c){e=qe(e)?e:Tr(e),n=n&&!c?H(n):0;var h=e.length;return n<0&&(n=we(h+n,0)),vs(e)?n<=h&&e.indexOf(i,n)>-1:!!h&&wr(e,i,n)>-1}var Ty=F(function(e,i,n){var c=-1,h=typeof i=="function",d=qe(e)?_(e.length):[];return Ht(e,function(f){d[++c]=h?He(i,f,n):si(f,i,n)}),d}),xy=is(function(e,i,n){St(e,n,i)});function ps(e,i){var n=z(e)?ce:oc;return n(e,U(i,3))}function Ay(e,i,n,c){return e==null?[]:(z(i)||(i=i==null?[]:[i]),n=c?r:n,z(n)||(n=n==null?[]:[n]),hc(e,i,n))}var Dy=is(function(e,i,n){e[n?0:1].push(i)},function(){return[[],[]]});function qy(e,i,n){var c=z(e)?tn:Da,h=arguments.length<3;return c(e,U(i,4),n,h,Ht)}function jy(e,i,n){var c=z(e)?Bp:Da,h=arguments.length<3;return c(e,U(i,4),n,h,Xa)}function Uy(e,i){var n=z(e)?Mt:ec;return n(e,gs(U(i,3)))}function My(e){var i=z(e)?Qa:Cf;return i(e)}function Ly(e,i,n){(n?Te(e,i,n):i===r)?i=1:i=H(i);var c=z(e)?af:Tf;return c(e,i)}function ky(e){var i=z(e)?cf:Af;return i(e)}function zy(e){if(e==null)return 0;if(qe(e))return vs(e)?br(e):e.length;var i=Oe(e);return i==ot||i==at?e.size:bn(e).length}function Hy(e,i,n){var c=z(e)?rn:Df;return n&&Te(e,i,n)&&(i=r),c(e,U(i,3))}var Vy=F(function(e,i){if(e==null)return[];var n=i.length;return n>1&&Te(e,i[0],i[1])?i=[]:n>2&&Te(i[0],i[1],i[2])&&(i=[i[0]]),hc(e,Ie(i,1),[])}),ds=Ed||function(){return Ee.Date.now()};function Ky(e,i){if(typeof i!="function")throw new Ze(l);return e=H(e),function(){if(--e<1)return i.apply(this,arguments)}}function su(e,i,n){return i=n?r:i,i=e&&i==null?e.length:i,Ot(e,de,r,r,r,r,i)}function nu(e,i){var n;if(typeof i!="function")throw new Ze(l);return e=H(e),function(){return--e>0&&(n=i.apply(this,arguments)),e<=1&&(i=r),n}}var Fn=F(function(e,i,n){var c=A;if(n.length){var h=kt(n,$r(Fn));c|=ae}return Ot(e,c,i,n,h)}),ou=F(function(e,i,n){var c=A|B;if(n.length){var h=kt(n,$r(ou));c|=ae}return Ot(i,c,e,n,h)});function au(e,i,n){i=n?r:i;var c=Ot(e,J,r,r,r,r,r,i);return c.placeholder=au.placeholder,c}function cu(e,i,n){i=n?r:i;var c=Ot(e,Y,r,r,r,r,r,i);return c.placeholder=cu.placeholder,c}function uu(e,i,n){var c,h,d,f,y,m,I=0,P=!1,O=!1,C=!0;if(typeof e!="function")throw new Ze(l);i=it(i)||0,he(n)&&(P=!!n.leading,O="maxWait"in n,d=O?we(it(n.maxWait)||0,i):d,C="trailing"in n?!!n.trailing:C);function D(ge){var lt=c,Tt=h;return c=h=r,I=ge,f=e.apply(Tt,lt),f}function M(ge){return I=ge,y=ui(W,i),P?D(ge):f}function V(ge){var lt=ge-m,Tt=ge-I,Nu=i-lt;return O?Se(Nu,d-Tt):Nu}function L(ge){var lt=ge-m,Tt=ge-I;return m===r||lt>=i||lt<0||O&&Tt>=d}function W(){var ge=ds();if(L(ge))return Q(ge);y=ui(W,V(ge))}function Q(ge){return y=r,C&&c?D(ge):(c=h=r,f)}function We(){y!==r&&wc(y),I=0,c=m=h=y=r}function xe(){return y===r?f:Q(ds())}function Be(){var ge=ds(),lt=L(ge);if(c=arguments,h=this,m=ge,lt){if(y===r)return M(m);if(O)return wc(y),y=ui(W,i),D(m)}return y===r&&(y=ui(W,i)),f}return Be.cancel=We,Be.flush=xe,Be}var Fy=F(function(e,i){return Za(e,1,i)}),Wy=F(function(e,i,n){return Za(e,it(i)||0,n)});function By(e){return Ot(e,jt)}function fs(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Ze(l);var n=function(){var c=arguments,h=i?i.apply(this,c):c[0],d=n.cache;if(d.has(h))return d.get(h);var f=e.apply(this,c);return n.cache=d.set(h,f)||d,f};return n.cache=new(fs.Cache||Pt),n}fs.Cache=Pt;function gs(e){if(typeof e!="function")throw new Ze(l);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Gy(e){return nu(2,e)}var Qy=qf(function(e,i){i=i.length==1&&z(i[0])?ce(i[0],Ve(U())):ce(Ie(i,1),Ve(U()));var n=i.length;return F(function(c){for(var h=-1,d=Se(c.length,n);++h<d;)c[h]=i[h].call(this,c[h]);return He(e,this,c)})}),Wn=F(function(e,i){var n=kt(i,$r(Wn));return Ot(e,ae,r,i,n)}),hu=F(function(e,i){var n=kt(i,$r(hu));return Ot(e,Ne,r,i,n)}),Jy=Rt(function(e,i){return Ot(e,$e,r,r,r,i)});function Yy(e,i){if(typeof e!="function")throw new Ze(l);return i=i===r?i:H(i),F(e,i)}function Zy(e,i){if(typeof e!="function")throw new Ze(l);return i=i==null?0:we(H(i),0),F(function(n){var c=n[i],h=Ft(n,0,i);return c&&Lt(h,c),He(e,this,h)})}function Xy(e,i,n){var c=!0,h=!0;if(typeof e!="function")throw new Ze(l);return he(n)&&(c="leading"in n?!!n.leading:c,h="trailing"in n?!!n.trailing:h),uu(e,i,{leading:c,maxWait:i,trailing:h})}function ev(e){return su(e,1)}function tv(e,i){return Wn(Cn(i),e)}function rv(){if(!arguments.length)return[];var e=arguments[0];return z(e)?e:[e]}function iv(e){return et(e,j)}function sv(e,i){return i=typeof i=="function"?i:r,et(e,j,i)}function nv(e){return et(e,S|j)}function ov(e,i){return i=typeof i=="function"?i:r,et(e,S|j,i)}function av(e,i){return i==null||Ya(e,i,_e(i))}function ht(e,i){return e===i||e!==e&&i!==i}var cv=as(mn),uv=as(function(e,i){return e>=i}),ar=ic(function(){return arguments}())?ic:function(e){return le(e)&&ee.call(e,"callee")&&!Va.call(e,"callee")},z=_.isArray,hv=Pa?Ve(Pa):mf;function qe(e){return e!=null&&ys(e.length)&&!$t(e)}function fe(e){return le(e)&&qe(e)}function lv(e){return e===!0||e===!1||le(e)&&Ce(e)==Vr}var Wt=Pd||io,pv=Sa?Ve(Sa):wf;function dv(e){return le(e)&&e.nodeType===1&&!hi(e)}function fv(e){if(e==null)return!0;if(qe(e)&&(z(e)||typeof e=="string"||typeof e.splice=="function"||Wt(e)||Cr(e)||ar(e)))return!e.length;var i=Oe(e);if(i==ot||i==at)return!e.size;if(ci(e))return!bn(e).length;for(var n in e)if(ee.call(e,n))return!1;return!0}function gv(e,i){return ni(e,i)}function yv(e,i,n){n=typeof n=="function"?n:r;var c=n?n(e,i):r;return c===r?ni(e,i,r,n):!!c}function Bn(e){if(!le(e))return!1;var i=Ce(e);return i==Ni||i==Ml||typeof e.message=="string"&&typeof e.name=="string"&&!hi(e)}function vv(e){return typeof e=="number"&&Fa(e)}function $t(e){if(!he(e))return!1;var i=Ce(e);return i==$i||i==Zo||i==Ul||i==kl}function lu(e){return typeof e=="number"&&e==H(e)}function ys(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ut}function he(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function le(e){return e!=null&&typeof e=="object"}var pu=Oa?Ve(Oa):bf;function mv(e,i){return e===i||_n(e,i,Un(i))}function wv(e,i,n){return n=typeof n=="function"?n:r,_n(e,i,Un(i),n)}function _v(e){return du(e)&&e!=+e}function bv(e){if(sg(e))throw new k(u);return sc(e)}function Ev(e){return e===null}function Iv(e){return e==null}function du(e){return typeof e=="number"||le(e)&&Ce(e)==Fr}function hi(e){if(!le(e)||Ce(e)!=Et)return!1;var i=Vi(e);if(i===null)return!0;var n=ee.call(i,"constructor")&&i.constructor;return typeof n=="function"&&n instanceof n&&Li.call(n)==md}var Gn=Ra?Ve(Ra):Ef;function Pv(e){return lu(e)&&e>=-Ut&&e<=Ut}var fu=Na?Ve(Na):If;function vs(e){return typeof e=="string"||!z(e)&&le(e)&&Ce(e)==Br}function Fe(e){return typeof e=="symbol"||le(e)&&Ce(e)==Ci}var Cr=$a?Ve($a):Pf;function Sv(e){return e===r}function Ov(e){return le(e)&&Oe(e)==Gr}function Rv(e){return le(e)&&Ce(e)==Hl}var Nv=as(En),$v=as(function(e,i){return e<=i});function gu(e){if(!e)return[];if(qe(e))return vs(e)?ct(e):De(e);if(Yr&&e[Yr])return od(e[Yr]());var i=Oe(e),n=i==ot?un:i==at?ji:Tr;return n(e)}function Ct(e){if(!e)return e===0?e:0;if(e=it(e),e===Zt||e===-Zt){var i=e<0?-1:1;return i*Al}return e===e?e:0}function H(e){var i=Ct(e),n=i%1;return i===i?n?i-n:i:0}function yu(e){return e?ir(H(e),0,gt):0}function it(e){if(typeof e=="number")return e;if(Fe(e))return Oi;if(he(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=he(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=qa(e);var n=up.test(e);return n||lp.test(e)?Vp(e.slice(2),n?2:8):cp.test(e)?Oi:+e}function vu(e){return vt(e,je(e))}function Cv(e){return e?ir(H(e),-Ut,Ut):e===0?e:0}function X(e){return e==null?"":Ke(e)}var Tv=Rr(function(e,i){if(ci(i)||qe(i)){vt(i,_e(i),e);return}for(var n in i)ee.call(i,n)&&ri(e,n,i[n])}),mu=Rr(function(e,i){vt(i,je(i),e)}),ms=Rr(function(e,i,n,c){vt(i,je(i),e,c)}),xv=Rr(function(e,i,n,c){vt(i,_e(i),e,c)}),Av=Rt(gn);function Dv(e,i){var n=Or(e);return i==null?n:Ja(n,i)}var qv=F(function(e,i){e=re(e);var n=-1,c=i.length,h=c>2?i[2]:r;for(h&&Te(i[0],i[1],h)&&(c=1);++n<c;)for(var d=i[n],f=je(d),y=-1,m=f.length;++y<m;){var I=f[y],P=e[I];(P===r||ht(P,Ir[I])&&!ee.call(e,I))&&(e[I]=d[I])}return e}),jv=F(function(e){return e.push(r,qc),He(wu,r,e)});function Uv(e,i){return Ta(e,U(i,3),yt)}function Mv(e,i){return Ta(e,U(i,3),vn)}function Lv(e,i){return e==null?e:yn(e,U(i,3),je)}function kv(e,i){return e==null?e:tc(e,U(i,3),je)}function zv(e,i){return e&&yt(e,U(i,3))}function Hv(e,i){return e&&vn(e,U(i,3))}function Vv(e){return e==null?[]:Xi(e,_e(e))}function Kv(e){return e==null?[]:Xi(e,je(e))}function Qn(e,i,n){var c=e==null?r:sr(e,i);return c===r?n:c}function Fv(e,i){return e!=null&&Mc(e,i,ff)}function Jn(e,i){return e!=null&&Mc(e,i,gf)}var Wv=Cc(function(e,i,n){i!=null&&typeof i.toString!="function"&&(i=ki.call(i)),e[i]=n},Zn(Ue)),Bv=Cc(function(e,i,n){i!=null&&typeof i.toString!="function"&&(i=ki.call(i)),ee.call(e,i)?e[i].push(n):e[i]=[n]},U),Gv=F(si);function _e(e){return qe(e)?Ga(e):bn(e)}function je(e){return qe(e)?Ga(e,!0):Sf(e)}function Qv(e,i){var n={};return i=U(i,3),yt(e,function(c,h,d){St(n,i(c,h,d),c)}),n}function Jv(e,i){var n={};return i=U(i,3),yt(e,function(c,h,d){St(n,h,i(c,h,d))}),n}var Yv=Rr(function(e,i,n){es(e,i,n)}),wu=Rr(function(e,i,n,c){es(e,i,n,c)}),Zv=Rt(function(e,i){var n={};if(e==null)return n;var c=!1;i=ce(i,function(d){return d=Kt(d,e),c||(c=d.length>1),d}),vt(e,qn(e),n),c&&(n=et(n,S|R|j,Wf));for(var h=i.length;h--;)Rn(n,i[h]);return n});function Xv(e,i){return _u(e,gs(U(i)))}var em=Rt(function(e,i){return e==null?{}:Rf(e,i)});function _u(e,i){if(e==null)return{};var n=ce(qn(e),function(c){return[c]});return i=U(i),lc(e,n,function(c,h){return i(c,h[0])})}function tm(e,i,n){i=Kt(i,e);var c=-1,h=i.length;for(h||(h=1,e=r);++c<h;){var d=e==null?r:e[mt(i[c])];d===r&&(c=h,d=n),e=$t(d)?d.call(e):d}return e}function rm(e,i,n){return e==null?e:oi(e,i,n)}function im(e,i,n,c){return c=typeof c=="function"?c:r,e==null?e:oi(e,i,n,c)}var bu=Ac(_e),Eu=Ac(je);function sm(e,i,n){var c=z(e),h=c||Wt(e)||Cr(e);if(i=U(i,4),n==null){var d=e&&e.constructor;h?n=c?new d:[]:he(e)?n=$t(d)?Or(Vi(e)):{}:n={}}return(h?Ye:yt)(e,function(f,y,m){return i(n,f,y,m)}),n}function nm(e,i){return e==null?!0:Rn(e,i)}function om(e,i,n){return e==null?e:yc(e,i,Cn(n))}function am(e,i,n,c){return c=typeof c=="function"?c:r,e==null?e:yc(e,i,Cn(n),c)}function Tr(e){return e==null?[]:cn(e,_e(e))}function cm(e){return e==null?[]:cn(e,je(e))}function um(e,i,n){return n===r&&(n=i,i=r),n!==r&&(n=it(n),n=n===n?n:0),i!==r&&(i=it(i),i=i===i?i:0),ir(it(e),i,n)}function hm(e,i,n){return i=Ct(i),n===r?(n=i,i=0):n=Ct(n),e=it(e),yf(e,i,n)}function lm(e,i,n){if(n&&typeof n!="boolean"&&Te(e,i,n)&&(i=n=r),n===r&&(typeof i=="boolean"?(n=i,i=r):typeof e=="boolean"&&(n=e,e=r)),e===r&&i===r?(e=0,i=1):(e=Ct(e),i===r?(i=e,e=0):i=Ct(i)),e>i){var c=e;e=i,i=c}if(n||e%1||i%1){var h=Wa();return Se(e+h*(i-e+Hp("1e-"+((h+"").length-1))),i)}return Pn(e,i)}var pm=Nr(function(e,i,n){return i=i.toLowerCase(),e+(n?Iu(i):i)});function Iu(e){return Yn(X(e).toLowerCase())}function Pu(e){return e=X(e),e&&e.replace(dp,td).replace(xp,"")}function dm(e,i,n){e=X(e),i=Ke(i);var c=e.length;n=n===r?c:ir(H(n),0,c);var h=n;return n-=i.length,n>=0&&e.slice(n,h)==i}function fm(e){return e=X(e),e&&Bl.test(e)?e.replace(ta,rd):e}function gm(e){return e=X(e),e&&Xl.test(e)?e.replace(Fs,"\\$&"):e}var ym=Nr(function(e,i,n){return e+(n?"-":"")+i.toLowerCase()}),vm=Nr(function(e,i,n){return e+(n?" ":"")+i.toLowerCase()}),mm=Rc("toLowerCase");function wm(e,i,n){e=X(e),i=H(i);var c=i?br(e):0;if(!i||c>=i)return e;var h=(i-c)/2;return os(Bi(h),n)+e+os(Wi(h),n)}function _m(e,i,n){e=X(e),i=H(i);var c=i?br(e):0;return i&&c<i?e+os(i-c,n):e}function bm(e,i,n){e=X(e),i=H(i);var c=i?br(e):0;return i&&c<i?os(i-c,n)+e:e}function Em(e,i,n){return n||i==null?i=0:i&&(i=+i),Nd(X(e).replace(Ws,""),i||0)}function Im(e,i,n){return(n?Te(e,i,n):i===r)?i=1:i=H(i),Sn(X(e),i)}function Pm(){var e=arguments,i=X(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Sm=Nr(function(e,i,n){return e+(n?"_":"")+i.toLowerCase()});function Om(e,i,n){return n&&typeof n!="number"&&Te(e,i,n)&&(i=n=r),n=n===r?gt:n>>>0,n?(e=X(e),e&&(typeof i=="string"||i!=null&&!Gn(i))&&(i=Ke(i),!i&&_r(e))?Ft(ct(e),0,n):e.split(i,n)):[]}var Rm=Nr(function(e,i,n){return e+(n?" ":"")+Yn(i)});function Nm(e,i,n){return e=X(e),n=n==null?0:ir(H(n),0,e.length),i=Ke(i),e.slice(n,n+i.length)==i}function $m(e,i,n){var c=p.templateSettings;n&&Te(e,i,n)&&(i=r),e=X(e),i=ms({},i,c,Dc);var h=ms({},i.imports,c.imports,Dc),d=_e(h),f=cn(h,d),y,m,I=0,P=i.interpolate||Ti,O="__p += '",C=hn((i.escape||Ti).source+"|"+P.source+"|"+(P===ra?ap:Ti).source+"|"+(i.evaluate||Ti).source+"|$","g"),D="//# sourceURL="+(ee.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Up+"]")+`
`;e.replace(C,function(L,W,Q,We,xe,Be){return Q||(Q=We),O+=e.slice(I,Be).replace(fp,id),W&&(y=!0,O+=`' +
__e(`+W+`) +
'`),xe&&(m=!0,O+=`';
`+xe+`;
__p += '`),Q&&(O+=`' +
((__t = (`+Q+`)) == null ? '' : __t) +
'`),I=Be+L.length,L}),O+=`';
`;var M=ee.call(i,"variable")&&i.variable;if(!M)O=`with (obj) {
`+O+`
}
`;else if(np.test(M))throw new k(g);O=(m?O.replace(Vl,""):O).replace(Kl,"$1").replace(Fl,"$1;"),O="function("+(M||"obj")+`) {
`+(M?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(y?", __e = _.escape":"")+(m?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+O+`return __p
}`;var V=Ou(function(){return Z(d,D+"return "+O).apply(r,f)});if(V.source=O,Bn(V))throw V;return V}function Cm(e){return X(e).toLowerCase()}function Tm(e){return X(e).toUpperCase()}function xm(e,i,n){if(e=X(e),e&&(n||i===r))return qa(e);if(!e||!(i=Ke(i)))return e;var c=ct(e),h=ct(i),d=ja(c,h),f=Ua(c,h)+1;return Ft(c,d,f).join("")}function Am(e,i,n){if(e=X(e),e&&(n||i===r))return e.slice(0,La(e)+1);if(!e||!(i=Ke(i)))return e;var c=ct(e),h=Ua(c,ct(i))+1;return Ft(c,0,h).join("")}function Dm(e,i,n){if(e=X(e),e&&(n||i===r))return e.replace(Ws,"");if(!e||!(i=Ke(i)))return e;var c=ct(e),h=ja(c,ct(i));return Ft(c,h).join("")}function qm(e,i){var n=Rl,c=Nl;if(he(i)){var h="separator"in i?i.separator:h;n="length"in i?H(i.length):n,c="omission"in i?Ke(i.omission):c}e=X(e);var d=e.length;if(_r(e)){var f=ct(e);d=f.length}if(n>=d)return e;var y=n-br(c);if(y<1)return c;var m=f?Ft(f,0,y).join(""):e.slice(0,y);if(h===r)return m+c;if(f&&(y+=m.length-y),Gn(h)){if(e.slice(y).search(h)){var I,P=m;for(h.global||(h=hn(h.source,X(ia.exec(h))+"g")),h.lastIndex=0;I=h.exec(P);)var O=I.index;m=m.slice(0,O===r?y:O)}}else if(e.indexOf(Ke(h),y)!=y){var C=m.lastIndexOf(h);C>-1&&(m=m.slice(0,C))}return m+c}function jm(e){return e=X(e),e&&Wl.test(e)?e.replace(ea,hd):e}var Um=Nr(function(e,i,n){return e+(n?" ":"")+i.toUpperCase()}),Yn=Rc("toUpperCase");function Su(e,i,n){return e=X(e),i=n?r:i,i===r?nd(e)?dd(e):Jp(e):e.match(i)||[]}var Ou=F(function(e,i){try{return He(e,r,i)}catch(n){return Bn(n)?n:new k(n)}}),Mm=Rt(function(e,i){return Ye(i,function(n){n=mt(n),St(e,n,Fn(e[n],e))}),e});function Lm(e){var i=e==null?0:e.length,n=U();return e=i?ce(e,function(c){if(typeof c[1]!="function")throw new Ze(l);return[n(c[0]),c[1]]}):[],F(function(c){for(var h=-1;++h<i;){var d=e[h];if(He(d[0],this,c))return He(d[1],this,c)}})}function km(e){return lf(et(e,S))}function Zn(e){return function(){return e}}function zm(e,i){return e==null||e!==e?i:e}var Hm=$c(),Vm=$c(!0);function Ue(e){return e}function Xn(e){return nc(typeof e=="function"?e:et(e,S))}function Km(e){return ac(et(e,S))}function Fm(e,i){return cc(e,et(i,S))}var Wm=F(function(e,i){return function(n){return si(n,e,i)}}),Bm=F(function(e,i){return function(n){return si(e,n,i)}});function eo(e,i,n){var c=_e(i),h=Xi(i,c);n==null&&!(he(i)&&(h.length||!c.length))&&(n=i,i=e,e=this,h=Xi(i,_e(i)));var d=!(he(n)&&"chain"in n)||!!n.chain,f=$t(e);return Ye(h,function(y){var m=i[y];e[y]=m,f&&(e.prototype[y]=function(){var I=this.__chain__;if(d||I){var P=e(this.__wrapped__),O=P.__actions__=De(this.__actions__);return O.push({func:m,args:arguments,thisArg:e}),P.__chain__=I,P}return m.apply(e,Lt([this.value()],arguments))})}),e}function Gm(){return Ee._===this&&(Ee._=wd),this}function to(){}function Qm(e){return e=H(e),F(function(i){return uc(i,e)})}var Jm=xn(ce),Ym=xn(Ca),Zm=xn(rn);function Ru(e){return Ln(e)?sn(mt(e)):Nf(e)}function Xm(e){return function(i){return e==null?r:sr(e,i)}}var ew=Tc(),tw=Tc(!0);function ro(){return[]}function io(){return!1}function rw(){return{}}function iw(){return""}function sw(){return!0}function nw(e,i){if(e=H(e),e<1||e>Ut)return[];var n=gt,c=Se(e,gt);i=U(i),e-=gt;for(var h=an(c,i);++n<e;)i(n);return h}function ow(e){return z(e)?ce(e,mt):Fe(e)?[e]:De(Bc(X(e)))}function aw(e){var i=++vd;return X(e)+i}var cw=ns(function(e,i){return e+i},0),uw=An("ceil"),hw=ns(function(e,i){return e/i},1),lw=An("floor");function pw(e){return e&&e.length?Zi(e,Ue,mn):r}function dw(e,i){return e&&e.length?Zi(e,U(i,2),mn):r}function fw(e){return Aa(e,Ue)}function gw(e,i){return Aa(e,U(i,2))}function yw(e){return e&&e.length?Zi(e,Ue,En):r}function vw(e,i){return e&&e.length?Zi(e,U(i,2),En):r}var mw=ns(function(e,i){return e*i},1),ww=An("round"),_w=ns(function(e,i){return e-i},0);function bw(e){return e&&e.length?on(e,Ue):0}function Ew(e,i){return e&&e.length?on(e,U(i,2)):0}return p.after=Ky,p.ary=su,p.assign=Tv,p.assignIn=mu,p.assignInWith=ms,p.assignWith=xv,p.at=Av,p.before=nu,p.bind=Fn,p.bindAll=Mm,p.bindKey=ou,p.castArray=rv,p.chain=tu,p.chunk=lg,p.compact=pg,p.concat=dg,p.cond=Lm,p.conforms=km,p.constant=Zn,p.countBy=by,p.create=Dv,p.curry=au,p.curryRight=cu,p.debounce=uu,p.defaults=qv,p.defaultsDeep=jv,p.defer=Fy,p.delay=Wy,p.difference=fg,p.differenceBy=gg,p.differenceWith=yg,p.drop=vg,p.dropRight=mg,p.dropRightWhile=wg,p.dropWhile=_g,p.fill=bg,p.filter=Iy,p.flatMap=Oy,p.flatMapDeep=Ry,p.flatMapDepth=Ny,p.flatten=Yc,p.flattenDeep=Eg,p.flattenDepth=Ig,p.flip=By,p.flow=Hm,p.flowRight=Vm,p.fromPairs=Pg,p.functions=Vv,p.functionsIn=Kv,p.groupBy=$y,p.initial=Og,p.intersection=Rg,p.intersectionBy=Ng,p.intersectionWith=$g,p.invert=Wv,p.invertBy=Bv,p.invokeMap=Ty,p.iteratee=Xn,p.keyBy=xy,p.keys=_e,p.keysIn=je,p.map=ps,p.mapKeys=Qv,p.mapValues=Jv,p.matches=Km,p.matchesProperty=Fm,p.memoize=fs,p.merge=Yv,p.mergeWith=wu,p.method=Wm,p.methodOf=Bm,p.mixin=eo,p.negate=gs,p.nthArg=Qm,p.omit=Zv,p.omitBy=Xv,p.once=Gy,p.orderBy=Ay,p.over=Jm,p.overArgs=Qy,p.overEvery=Ym,p.overSome=Zm,p.partial=Wn,p.partialRight=hu,p.partition=Dy,p.pick=em,p.pickBy=_u,p.property=Ru,p.propertyOf=Xm,p.pull=Ag,p.pullAll=Xc,p.pullAllBy=Dg,p.pullAllWith=qg,p.pullAt=jg,p.range=ew,p.rangeRight=tw,p.rearg=Jy,p.reject=Uy,p.remove=Ug,p.rest=Yy,p.reverse=Vn,p.sampleSize=Ly,p.set=rm,p.setWith=im,p.shuffle=ky,p.slice=Mg,p.sortBy=Vy,p.sortedUniq=Fg,p.sortedUniqBy=Wg,p.split=Om,p.spread=Zy,p.tail=Bg,p.take=Gg,p.takeRight=Qg,p.takeRightWhile=Jg,p.takeWhile=Yg,p.tap=py,p.throttle=Xy,p.thru=ls,p.toArray=gu,p.toPairs=bu,p.toPairsIn=Eu,p.toPath=ow,p.toPlainObject=vu,p.transform=sm,p.unary=ev,p.union=Zg,p.unionBy=Xg,p.unionWith=ey,p.uniq=ty,p.uniqBy=ry,p.uniqWith=iy,p.unset=nm,p.unzip=Kn,p.unzipWith=eu,p.update=om,p.updateWith=am,p.values=Tr,p.valuesIn=cm,p.without=sy,p.words=Su,p.wrap=tv,p.xor=ny,p.xorBy=oy,p.xorWith=ay,p.zip=cy,p.zipObject=uy,p.zipObjectDeep=hy,p.zipWith=ly,p.entries=bu,p.entriesIn=Eu,p.extend=mu,p.extendWith=ms,eo(p,p),p.add=cw,p.attempt=Ou,p.camelCase=pm,p.capitalize=Iu,p.ceil=uw,p.clamp=um,p.clone=iv,p.cloneDeep=nv,p.cloneDeepWith=ov,p.cloneWith=sv,p.conformsTo=av,p.deburr=Pu,p.defaultTo=zm,p.divide=hw,p.endsWith=dm,p.eq=ht,p.escape=fm,p.escapeRegExp=gm,p.every=Ey,p.find=Py,p.findIndex=Qc,p.findKey=Uv,p.findLast=Sy,p.findLastIndex=Jc,p.findLastKey=Mv,p.floor=lw,p.forEach=ru,p.forEachRight=iu,p.forIn=Lv,p.forInRight=kv,p.forOwn=zv,p.forOwnRight=Hv,p.get=Qn,p.gt=cv,p.gte=uv,p.has=Fv,p.hasIn=Jn,p.head=Zc,p.identity=Ue,p.includes=Cy,p.indexOf=Sg,p.inRange=hm,p.invoke=Gv,p.isArguments=ar,p.isArray=z,p.isArrayBuffer=hv,p.isArrayLike=qe,p.isArrayLikeObject=fe,p.isBoolean=lv,p.isBuffer=Wt,p.isDate=pv,p.isElement=dv,p.isEmpty=fv,p.isEqual=gv,p.isEqualWith=yv,p.isError=Bn,p.isFinite=vv,p.isFunction=$t,p.isInteger=lu,p.isLength=ys,p.isMap=pu,p.isMatch=mv,p.isMatchWith=wv,p.isNaN=_v,p.isNative=bv,p.isNil=Iv,p.isNull=Ev,p.isNumber=du,p.isObject=he,p.isObjectLike=le,p.isPlainObject=hi,p.isRegExp=Gn,p.isSafeInteger=Pv,p.isSet=fu,p.isString=vs,p.isSymbol=Fe,p.isTypedArray=Cr,p.isUndefined=Sv,p.isWeakMap=Ov,p.isWeakSet=Rv,p.join=Cg,p.kebabCase=ym,p.last=rt,p.lastIndexOf=Tg,p.lowerCase=vm,p.lowerFirst=mm,p.lt=Nv,p.lte=$v,p.max=pw,p.maxBy=dw,p.mean=fw,p.meanBy=gw,p.min=yw,p.minBy=vw,p.stubArray=ro,p.stubFalse=io,p.stubObject=rw,p.stubString=iw,p.stubTrue=sw,p.multiply=mw,p.nth=xg,p.noConflict=Gm,p.noop=to,p.now=ds,p.pad=wm,p.padEnd=_m,p.padStart=bm,p.parseInt=Em,p.random=lm,p.reduce=qy,p.reduceRight=jy,p.repeat=Im,p.replace=Pm,p.result=tm,p.round=ww,p.runInContext=v,p.sample=My,p.size=zy,p.snakeCase=Sm,p.some=Hy,p.sortedIndex=Lg,p.sortedIndexBy=kg,p.sortedIndexOf=zg,p.sortedLastIndex=Hg,p.sortedLastIndexBy=Vg,p.sortedLastIndexOf=Kg,p.startCase=Rm,p.startsWith=Nm,p.subtract=_w,p.sum=bw,p.sumBy=Ew,p.template=$m,p.times=nw,p.toFinite=Ct,p.toInteger=H,p.toLength=yu,p.toLower=Cm,p.toNumber=it,p.toSafeInteger=Cv,p.toString=X,p.toUpper=Tm,p.trim=xm,p.trimEnd=Am,p.trimStart=Dm,p.truncate=qm,p.unescape=jm,p.uniqueId=aw,p.upperCase=Um,p.upperFirst=Yn,p.each=ru,p.eachRight=iu,p.first=Zc,eo(p,function(){var e={};return yt(p,function(i,n){ee.call(p.prototype,n)||(e[n]=i)}),e}(),{chain:!1}),p.VERSION=s,Ye(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),Ye(["drop","take"],function(e,i){G.prototype[e]=function(n){n=n===r?1:we(H(n),0);var c=this.__filtered__&&!i?new G(this):this.clone();return c.__filtered__?c.__takeCount__=Se(n,c.__takeCount__):c.__views__.push({size:Se(n,gt),type:e+(c.__dir__<0?"Right":"")}),c},G.prototype[e+"Right"]=function(n){return this.reverse()[e](n).reverse()}}),Ye(["filter","map","takeWhile"],function(e,i){var n=i+1,c=n==Yo||n==xl;G.prototype[e]=function(h){var d=this.clone();return d.__iteratees__.push({iteratee:U(h,3),type:n}),d.__filtered__=d.__filtered__||c,d}}),Ye(["head","last"],function(e,i){var n="take"+(i?"Right":"");G.prototype[e]=function(){return this[n](1).value()[0]}}),Ye(["initial","tail"],function(e,i){var n="drop"+(i?"":"Right");G.prototype[e]=function(){return this.__filtered__?new G(this):this[n](1)}}),G.prototype.compact=function(){return this.filter(Ue)},G.prototype.find=function(e){return this.filter(e).head()},G.prototype.findLast=function(e){return this.reverse().find(e)},G.prototype.invokeMap=F(function(e,i){return typeof e=="function"?new G(this):this.map(function(n){return si(n,e,i)})}),G.prototype.reject=function(e){return this.filter(gs(U(e)))},G.prototype.slice=function(e,i){e=H(e);var n=this;return n.__filtered__&&(e>0||i<0)?new G(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),i!==r&&(i=H(i),n=i<0?n.dropRight(-i):n.take(i-e)),n)},G.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},G.prototype.toArray=function(){return this.take(gt)},yt(G.prototype,function(e,i){var n=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),h=p[c?"take"+(i=="last"?"Right":""):i],d=c||/^find/.test(i);h&&(p.prototype[i]=function(){var f=this.__wrapped__,y=c?[1]:arguments,m=f instanceof G,I=y[0],P=m||z(f),O=function(W){var Q=h.apply(p,Lt([W],y));return c&&C?Q[0]:Q};P&&n&&typeof I=="function"&&I.length!=1&&(m=P=!1);var C=this.__chain__,D=!!this.__actions__.length,M=d&&!C,V=m&&!D;if(!d&&P){f=V?f:new G(this);var L=e.apply(f,y);return L.__actions__.push({func:ls,args:[O],thisArg:r}),new Xe(L,C)}return M&&V?e.apply(this,y):(L=this.thru(O),M?c?L.value()[0]:L.value():L)})}),Ye(["pop","push","shift","sort","splice","unshift"],function(e){var i=Ui[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var h=arguments;if(c&&!this.__chain__){var d=this.value();return i.apply(z(d)?d:[],h)}return this[n](function(f){return i.apply(z(f)?f:[],h)})}}),yt(G.prototype,function(e,i){var n=p[i];if(n){var c=n.name+"";ee.call(Sr,c)||(Sr[c]=[]),Sr[c].push({name:i,func:n})}}),Sr[ss(r,B).name]=[{name:"wrapper",func:r}],G.prototype.clone=qd,G.prototype.reverse=jd,G.prototype.value=Ud,p.prototype.at=dy,p.prototype.chain=fy,p.prototype.commit=gy,p.prototype.next=yy,p.prototype.plant=my,p.prototype.reverse=wy,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=_y,p.prototype.first=p.prototype.head,Yr&&(p.prototype[Yr]=vy),p},Er=fd();Xt?((Xt.exports=Er)._=Er,Zs._=Er):Ee._=Er}).call(vi)})($o,$o.exports);var DI=Object.defineProperty,qI=Object.defineProperties,jI=Object.getOwnPropertyDescriptors,Ah=Object.getOwnPropertySymbols,UI=Object.prototype.hasOwnProperty,MI=Object.prototype.propertyIsEnumerable,Dh=(o,t,r)=>t in o?DI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,bs=(o,t)=>{for(var r in t||(t={}))UI.call(t,r)&&Dh(o,r,t[r]);if(Ah)for(var r of Ah(t))MI.call(t,r)&&Dh(o,r,t[r]);return o},LI=(o,t)=>qI(o,jI(t));function Jt(o,t,r){var s;const a=u_(o);return((s=t.rpcMap)==null?void 0:s[a.reference])||`${AI}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function gr(o){return o.includes(":")?o.split(":")[1]:o}function Sl(o){return o.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function kI(o,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(o));if(!r.length)return[];const s=[];return r.forEach(a=>{const u=t.namespaces[a].accounts;s.push(...u)}),s}function zI(o={},t={}){const r=qh(o),s=qh(t);return $o.exports.merge(r,s)}function qh(o){var t,r,s,a;const u={};if(!jr(o))return u;for(const[l,g]of Object.entries(o)){const w=Ko(l)?[l]:g.chains,b=g.methods||[],N=g.events||[],S=g.rpcMap||{},R=mi(l);u[R]=LI(bs(bs({},u[R]),g),{chains:oo(w,(t=u[R])==null?void 0:t.chains),methods:oo(b,(r=u[R])==null?void 0:r.methods),events:oo(N,(s=u[R])==null?void 0:s.events),rpcMap:bs(bs({},S),(a=u[R])==null?void 0:a.rpcMap)})}return u}function HI(o){return o.includes(":")?o.split(":")[2]:o}function VI(o){const t={};for(const[r,s]of Object.entries(o)){const a=s.methods||[],u=s.events||[],l=s.accounts||[],g=Ko(r)?[r]:s.chains?s.chains:Sl(s.accounts);t[r]={chains:g,methods:a,events:u,accounts:l}}return t}function fo(o){return typeof o=="number"?o:o.includes("0x")?parseInt(o,16):o.includes(":")?Number(o.split(":")[1]):Number(o)}const Ol={},ue=o=>Ol[o],go=(o,t)=>{Ol[o]=t};class KI{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=ue("events"),this.client=ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=gr(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Jt(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Dt(new Yt(s,ue("disableProviderPing")))}}class FI{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=ue("events"),this.client=ue("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Jt(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Dt(new Yt(s,ue("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(gr(r));t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const u=parseInt(a,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class WI{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=ue("events"),this.client=ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=gr(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Jt(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Dt(new Yt(s,ue("disableProviderPing")))}}class BI{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=ue("events"),this.client=ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=gr(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Jt(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Dt(new Yt(s,ue("disableProviderPing")))}}class GI{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=ue("events"),this.client=ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=gr(r);t[a]=this.createHttpProvider(a,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Dt(new Yt(s,ue("disableProviderPing")))}}class QI{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=ue("events"),this.client=ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=gr(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Jt(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Dt(new Yt(s,ue("disableProviderPing")))}}class JI{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=ue("events"),this.client=ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=gr(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Jt(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new Dt(new Yt(s,ue("disableProviderPing")))}}class YI{constructor(t){this.name="near",this.namespace=t.namespace,this.events=ue("events"),this.client=ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Jt(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(qt.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Jt(t,this.namespace);return typeof s>"u"?void 0:new Dt(new Yt(s,ue("disableProviderPing")))}}var ZI=Object.defineProperty,XI=Object.defineProperties,eP=Object.getOwnPropertyDescriptors,jh=Object.getOwnPropertySymbols,tP=Object.prototype.hasOwnProperty,rP=Object.prototype.propertyIsEnumerable,Uh=(o,t,r)=>t in o?ZI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,Es=(o,t)=>{for(var r in t||(t={}))tP.call(t,r)&&Uh(o,r,t[r]);if(jh)for(var r of jh(t))rP.call(t,r)&&Uh(o,r,t[r]);return o},yo=(o,t)=>XI(o,eP(t));class Qo{constructor(t){this.events=new Ao,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Cs(Ts({level:(t==null?void 0:t.logger)||Th})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Qo(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Es({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){const a=new Date().getTime();this.request(t,s).then(u=>r(null,xs(a,u))).catch(u=>r(u,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:ye("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(u=>{this.session=u,this.namespaces||(this.namespaces=VI(u.namespaces),this.persist("namespaces",this.namespaces))}).catch(u=>{if(u.message!==Il)throw u;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(hr(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await wI.init({logger:this.providerOpts.logger||Th,relayUrl:this.providerOpts.relayUrl||CI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>mi(r)))];go("client",this.client),go("events",this.events),go("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=kI(r,this.session),a=Sl(s),u=zI(this.namespaces,this.optionalNamespaces),l=yo(Es({},u[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new FI({namespace:l});break;case"solana":this.rpcProviders[r]=new WI({namespace:l});break;case"cosmos":this.rpcProviders[r]=new BI({namespace:l});break;case"polkadot":this.rpcProviders[r]=new KI({namespace:l});break;case"cip34":this.rpcProviders[r]=new GI({namespace:l});break;case"elrond":this.rpcProviders[r]=new QI({namespace:l});break;case"multiversx":this.rpcProviders[r]=new JI({namespace:l});break;case"near":this.rpcProviders[r]=new YI({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&hr(a)&&this.events.emit("accountsChanged",a.map(HI))}else if(s.name==="chainChanged"){const a=r.chainId,u=r.event.data,l=mi(a),g=fo(a)!==fo(u)?`${l}:${fo(u)}`:a;this.onChainChanged(g)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,u=(s=this.client)==null?void 0:s.session.get(t);this.session=yo(Es({},u),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",yo(Es({},ye("USER_DISCONNECTED")),{data:t.topic}))}),this.on(qt.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(l=>mi(l)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=mi(Object.keys(this.namespaces)[0]),u=this.rpcProviders[a].getDefaultChain();return[a,u]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,u]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(u),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${xh}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${xh}/${t}`)}}const iP=Qo,sP="wc",nP="ethereum_provider",oP=`${sP}@2:${nP}:`,aP="https://rpc.walletconnect.com/v1/",Co=["eth_sendTransaction","personal_sign"],cP=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],To=["chainChanged","accountsChanged"],uP=["chainChanged","accountsChanged","message","disconnect","connect"];var hP=Object.defineProperty,lP=Object.defineProperties,pP=Object.getOwnPropertyDescriptors,Mh=Object.getOwnPropertySymbols,dP=Object.prototype.hasOwnProperty,fP=Object.prototype.propertyIsEnumerable,Lh=(o,t,r)=>t in o?hP(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r,_i=(o,t)=>{for(var r in t||(t={}))dP.call(t,r)&&Lh(o,r,t[r]);if(Mh)for(var r of Mh(t))fP.call(t,r)&&Lh(o,r,t[r]);return o},kh=(o,t)=>lP(o,pP(t));function Ns(o){return Number(o[0].split(":")[1])}function vo(o){return`0x${o.toString(16)}`}function gP(o){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:u,optionalEvents:l,rpcMap:g}=o;if(!mo(t))throw new Error("Invalid chains");const w={chains:t,methods:s||Co,events:u||To,rpcMap:_i({},t.length?{[Ns(t)]:g[Ns(t)]}:{})},b=u==null?void 0:u.filter(j=>!To.includes(j)),N=s==null?void 0:s.filter(j=>!Co.includes(j));if(!r&&!l&&!a&&!(b!=null&&b.length)&&!(N!=null&&N.length))return{required:t.length?w:void 0};const S=(b==null?void 0:b.length)&&(N==null?void 0:N.length)||!r,R={chains:[...new Set(S?w.chains.concat(r||[]):r)],methods:[...new Set(w.methods.concat(a!=null&&a.length?a:cP))],events:[...new Set(w.events.concat(l!=null&&l.length?l:uP))],rpcMap:g};return{required:t.length?w:void 0,optional:r.length?R:void 0}}class Jo{constructor(){this.events=new bt.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=oP,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Jo;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=gP(this.rpc);try{const a=await new Promise(async(l,g)=>{var w;this.rpc.showQrModal&&((w=this.modal)==null||w.subscribeModal(b=>{!b.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(kh(_i({namespaces:_i({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(b=>{l(b)}).catch(b=>{g(new Error(b.message))})});if(!a)return;const u=Bw(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:u),this.setAccounts(u),this.events.emit("connect",{chainId:vo(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",vo(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",kh(_i({},Qw("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",vo(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const a=(r=t==null?void 0:t.chains)!=null?r:[],u=(s=t==null?void 0:t.optionalChains)!=null?s:[],l=a.concat(u);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=a.length?(t==null?void 0:t.methods)||Co:[],w=a.length?(t==null?void 0:t.events)||To:[],b=(t==null?void 0:t.optionalMethods)||[],N=(t==null?void 0:t.optionalEvents)||[],S=(t==null?void 0:t.rpcMap)||this.buildRpcMap(l,t.projectId),R=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(j=>this.formatChainId(j)),optionalChains:u.map(j=>this.formatChainId(j)),methods:g,events:w,optionalMethods:b,optionalEvents:N,rpcMap:S,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:R,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Ns(this.rpc.chains):Ns(this.rpc.optionalChains),this.signer=await iP.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Sw(()=>import("./index-B-0vsM22.js").then(a=>a.i),__vite__mapDeps([0,1,2]));r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(_i({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&mo(r)&&(this.rpc.chains=r.map(u=>this.formatChainId(u)),r.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)})),s&&mo(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(u=>this.formatChainId(u)),s.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${aP}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const AP=Jo;export{AP as EthereumProvider,uP as OPTIONAL_EVENTS,cP as OPTIONAL_METHODS,To as REQUIRED_EVENTS,Co as REQUIRED_METHODS,Jo as default};
